<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>113å­¸å¹´-åº·è»’(äº”ä¸Š)åœ‹èªç·šä¸ŠæœŸæœ«æ¸¬é©—ç³»çµ±</title>
    <style>
        :root {
            --primary: #4a90e2; /* å°ˆæ¥­è— */
            --secondary: #50e3c2; /* æ´»æ½‘ç¶  */
            --accent: #ff6b6b; /* è­¦ç¤ºç´… */
            --bg: #f4f7f6;
            --card-bg: #ffffff;
            --text: #333333;
        }

        body {
            font-family: "Microsoft JhengHei", "Heiti TC", sans-serif;
            background-color: var(--bg);
            color: var(--text);
            margin: 0;
            padding: 0;
            padding-bottom: 100px; /* ç•™çµ¦ Footer */
        }

        /* æ¨™é¡Œåˆ— */
        header {
            background: linear-gradient(135deg, var(--primary), #8e44ad);
            color: white;
            padding: 15px 20px;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        h1 { margin: 0; font-size: 1.6rem; letter-spacing: 1px; }
        
        #timer-box {
            background: rgba(0, 0, 0, 0.25);
            display: inline-block;
            padding: 5px 20px;
            border-radius: 20px;
            margin-top: 10px;
            font-size: 1.5rem;
            font-weight: bold;
            font-family: monospace;
        }

        .container {
            max-width: 900px;
            margin: 20px auto;
            padding: 0 15px;
        }

        /* æ­¡è¿ç•«é¢ */
        #start-screen {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 50px;
            text-align: center;
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
            margin-top: 50px;
        }

        .btn-start {
            background: var(--secondary);
            color: #005f4e;
            font-size: 1.5rem;
            padding: 15px 50px;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            font-weight: bold;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .btn-start:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(80, 227, 194, 0.4);
        }

        .btn-admin {
            margin-top: 20px;
            background: #ccc;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9rem;
        }

        /* é¡Œç›®å¡ç‰‡ */
        .question-card {
            background: var(--card-bg);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            border-left: 6px solid var(--primary);
            position: relative;
            transition: background-color 0.3s;
        }

        .question-card.review-marked {
            background-color: #fff8e1; /* é»ƒè‰²æ¨™è¨˜ */
            border-left-color: #f1c40f;
        }

        .question-text {
            font-size: 1.15rem;
            font-weight: bold;
            margin-bottom: 15px;
            line-height: 1.5;
        }

        .options-group label {
            display: block;
            margin: 8px 0;
            padding: 10px;
            background: #f9f9f9;
            border-radius: 8px;
            cursor: pointer;
            transition: background 0.2s;
        }

        .options-group label:hover { background: #eef2f5; }
        .options-group input { margin-right: 10px; transform: scale(1.2); }

        /* ç¨å¾Œä½œç­”å‹¾é¸ */
        .review-check {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 0.9rem;
            color: #777;
            display: flex;
            align-items: center;
            cursor: pointer;
        }
        .review-check input { margin-right: 5px; }

        /* é–±è®€æ¸¬é©—å€å¡Š */
        .reading-section {
            background: #e3f2fd;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            border: 2px dashed var(--primary);
            line-height: 1.8;
            font-size: 1.05rem;
        }

        /* åº•éƒ¨æ§åˆ¶åˆ— */
        footer {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background: #ffffff;
            border-top: 1px solid #ddd;
            padding: 10px 0;
            box-shadow: 0 -4px 10px rgba(0,0,0,0.05);
            display: flex;
            flex-direction: column;
            align-items: center;
            z-index: 900;
        }

        .stats-bar {
            display: flex;
            gap: 20px;
            font-size: 0.9rem;
            margin-bottom: 8px;
            width: 100%;
            justify-content: center;
            background: #f0f0f0;
            padding: 5px 0;
        }

        .stat-item b { font-size: 1.1rem; }
        .stat-answered { color: var(--primary); }
        .stat-unanswered { color: var(--accent); }
        .stat-review { color: #f39c12; }

        .submit-btn {
            background: var(--accent);
            color: white;
            border: none;
            padding: 12px 60px;
            border-radius: 30px;
            font-size: 1.2rem;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 4px 10px rgba(255, 107, 107, 0.4);
        }
        .submit-btn:hover { background: #ff5252; }

        /* çµæœæ¨£å¼ */
        .wrong-answer-card {
            border-left-color: var(--accent) !important;
            background-color: #fff0f0 !important;
        }
        .correct-answer-text {
            color: #d32f2f;
            font-weight: bold;
            margin-top: 10px;
            padding: 5px;
            background: rgba(255, 0, 0, 0.05);
            border-radius: 4px;
        }
        .user-wrong { text-decoration: line-through; color: #999; }
        .score-display {
            font-size: 2.5rem;
            color: var(--primary);
            font-weight: bold;
            text-align: center;
            margin-bottom: 20px;
        }

        .hidden { display: none !important; }
    </style>
</head>
<body>

<header>
    <h1>113å­¸å¹´-åº·è»’(äº”ä¸Š)åœ‹èªç·šä¸ŠæœŸæœ«æ¸¬é©—ç³»çµ±</h1>
    <div id="timer-box">40:00</div>
</header>

<div class="container" id="main-container">
    <div id="start-screen">
        <h2>ğŸ‘‹ å„ä½å®¶é•·èˆ‡åŒå­¸å¥½ï¼</h2>
        <p style="font-size: 1.1rem; line-height: 1.6;">
            é€™æ˜¯ç”±è£œæ•™åå¸«ç²¾é¸çš„ã€Œåº·è»’äº”ä¸ŠæœŸæœ«è€ƒã€æ¨¡æ“¬è©¦é¡Œã€‚<br>
            ç¯„åœåŒ…å«ï¼šç•«å®¶çš„å¤©ç©ºã€L7-L12ã€é–±è®€éšæ¢¯äºŒã€‚<br>
            å…± 50 é¡Œï¼Œæ»¿åˆ† 100 åˆ†ã€‚æº–å‚™å¥½äº†å—ï¼Ÿ
        </p>
        <button class="btn-start" onclick="startQuiz()">é–‹å§‹ä½œç­” (è¨ˆæ™‚é–‹å§‹)</button>
        <br>
        <button class="btn-admin" onclick="showAnswerKey()">ğŸ”‘ é¡¯ç¤ºç­”æ¡ˆ (å®¶é•·å°ˆç”¨)</button>
    </div>

    <div id="quiz-area" class="hidden">
        <form id="quiz-form">
            </form>
        <div style="height: 100px;"></div> </div>
    
    <div id="result-area" class="hidden">
        <div class="score-display" id="final-score"></div>
        <div style="text-align: center; margin-bottom: 20px;">
            <p>éŒ¯é¡Œå·²æ¨™ç¤ºç‚ºç´…è‰²ï¼Œè«‹è©³ç´°æª¢æŸ¥ã€‚<br>ç³»çµ±å·²è‡ªå‹•æ•´ç†éŒ¯é¡Œä¸¦ä¸‹è¼‰ç‚º Excel/CSV æª”ã€‚</p>
        </div>
        </div>
</div>

<footer id="footer-controls" class="hidden">
    <div class="stats-bar">
        <span class="stat-item stat-answered">å·²ç­”ï¼š<b id="count-ans">0</b></span>
        <span class="stat-item stat-unanswered">æœªç­”ï¼š<b id="count-unans">50</b></span>
        <span class="stat-item stat-review">ç¨å¾Œä½œç­”ï¼š<b id="count-review">0</b></span>
    </div>
    <button class="submit-btn" onclick="preSubmitCheck()">ç¹³å·é€å‡º</button>
</footer>

<script>
    // é¡Œåº«è³‡æ–™ (æ¨¡æ“¬è€ƒå¤é¡Œ)
    const questions = [
        // æ˜¯éé¡Œ (1-10)
        {id:1, type:'tf', q:'ã€ç¬¬ä¸ƒèª²ã€‘åœ¨ã€Œç‚ºç”Ÿå‘½æ‰¾å‡ºå£ã€ä¸­ï¼Œä½œè€…æåˆ°æ²™æ¼ ä¸­çš„æ¤ç‰©ç‚ºäº†ç”Ÿå­˜ï¼Œå¿…é ˆæœ‰å¾ˆæ·±çš„æ ¹æˆ–å¾ˆåšçš„çš®ï¼Œé€™æ˜¯ç”Ÿå‘½é©æ‡‰ç’°å¢ƒçš„è¡¨ç¾ã€‚', a:'O'},
        {id:2, type:'tf', q:'ã€é–±è®€éšæ¢¯ä¸€ã€‘é½Šç™½çŸ³æ˜¯è¿‘ä»£è‘—åçš„ç•«å®¶ï¼Œä»–ç•«è¦å­æœ€è¬›ç©¶çš„æ˜¯ã€ŒåƒçœŸçš„ä¸€æ¨£ã€ï¼Œé€£è¦å­çš„è…³æ•¸éƒ½å¿…é ˆå®Œå…¨æ­£ç¢ºï¼Œä¸èƒ½æœ‰è—è¡“èª‡å¼µã€‚', a:'X'},
        {id:3, type:'tf', q:'ã€ç¬¬å…«èª²ã€‘é¦¬æ‹‰æ‹‰å› ç‚ºçˆ­å–å¥³å­©å—æ•™è‚²çš„æ¬Šåˆ©è€Œå—å‚·ï¼Œä½†å¥¹æ²’æœ‰å› æ­¤é€€ç¸®ï¼Œåè€Œæ›´å‹‡æ•¢åœ°ç‚ºå…’ç«¥ç™¼è²ã€‚', a:'O'},
        {id:4, type:'tf', q:'ã€ç¬¬ä¹èª²ã€‘ã€Œåœ¨æŒ«æŠ˜ä¸­æˆé•·ã€ä¸€æ–‡å‘Šè¨´æˆ‘å€‘ï¼ŒæŒ«æŠ˜æ˜¯å¤±æ•—çš„è±¡å¾µï¼Œé‡åˆ°æŒ«æŠ˜ä»£è¡¨æˆ‘å€‘æ²’æœ‰å¤©åˆ†ã€‚', a:'X'},
        {id:5, type:'tf', q:'ã€ç¬¬åèª²ã€‘ã€Œå±±ä¸­å¯„æƒ…ã€çš„ä½œè€…èªç‚ºï¼Œåªæœ‰æ™´å¤©çš„å±±æ—æ‰å€¼å¾—æ¬£è³ï¼Œé›¨å¤©çš„å±±æ—å……æ»¿å±éšªèˆ‡é™°æš—ï¼Œä¸å€¼å¾—åœç•™ã€‚', a:'X'},
        {id:6, type:'tf', q:'ã€ç¬¬åä¸€èª²ã€‘åœ¨å¸ƒè¾²æ—çš„å‚³èªªä¸­ï¼Œé»‘ç†Šæ›¾å¹«åŠ©éäººé¡ï¼Œæ‰€ä»¥å¸ƒè¾²æ—äººå°‡é»‘ç†Šè¦–ç‚ºæœ‹å‹ï¼Œä¸å¯ä»¥éš¨æ„çµæ®ºã€‚', a:'O'},
        {id:7, type:'tf', q:'ã€ç¬¬åäºŒèª²ã€‘é­¯æ¿±éœæ¼‚æµåˆ°è’å³¶å¾Œï¼Œå› ç‚ºçµ•æœ›è€Œæ•´å¤©å“­æ³£ï¼Œæœ€å¾Œæ˜¯ç­‰å¾…åˆ¥äººçš„æ•‘æ´æ‰æ´»ä¸‹ä¾†çš„ã€‚', a:'X'},
        {id:8, type:'tf', q:'ã€é–±è®€éšæ¢¯äºŒã€‘ã€Œåˆ†äº«çš„é‡‘ç‰Œã€æ•…äº‹ä¸­ï¼Œç‰¹å¥§æœƒçš„è·‘è€…è·Œå€’äº†ï¼Œå…¶ä»–åƒè³½è€…åœä¸‹è…³æ­¥æ‰¶èµ·ä»–ï¼Œæœ€å¾Œå¤§å®¶ä¸€èµ·æ‰‹ç‰½æ‰‹èµ°å‘çµ‚é»ã€‚', a:'O'},
        {id:9, type:'tf', q:'ã€å­—éŸ³å­—å½¢ã€‘ã€Œå¼·ã€äººæ‰€é›£çš„ã€Œå¼·ã€è®€ä½œã€Œã„‘ã„§ã„¤ËŠã€ã€‚', a:'X'}, // æ‡‰ç‚º ã„‘ã„§ã„¤Ë‡
        {id:10, type:'tf', q:'ã€ä¿®è¾­ã€‘ã€Œé‚£é›™çœ¼ç›åƒæ˜Ÿæ˜Ÿä¸€æ¨£é–ƒäº®ã€‚ã€é€™æ˜¯ä½¿ç”¨äº†ã€Œæ“¬äººã€ä¿®è¾­ã€‚', a:'X'}, // è­¬å–»

        // é¸æ“‡é¡Œ (11-40)
        {id:11, type:'mc', q:'ã€ç¬¬ä¸ƒèª²ã€‘ä¸‹åˆ—å“ªä¸€ç¨®è‡ªç„¶æ™¯è±¡ã€Œä¸æ˜¯ã€æ–‡ä¸­æåˆ°å±•ç¾ç”Ÿå‘½åŠ›çš„ä¾‹å­ï¼Ÿ', opts:['æ–·è…¿çš„èœ˜è››çµç¶²','çŸ³ç¸«ä¸­çš„å°è‰','æº«å®¤è£¡çš„èŠ±æœµ','æ²™æ¼ ä¸­çš„ä»™äººæŒ'], a:'æº«å®¤è£¡çš„èŠ±æœµ'},
        {id:12, type:'mc', q:'ã€ç¬¬å…«èª²ã€‘é¦¬æ‹‰æ‹‰ä¾†è‡ªå“ªå€‹åœ‹å®¶ï¼Ÿ', opts:['ç¾åœ‹','å·´åŸºæ–¯å¦','å°åº¦','é˜¿å¯Œæ±—'], a:'å·´åŸºæ–¯å¦'},
        {id:13, type:'mc', q:'ã€ç¬¬å…«èª²ã€‘ã€Œæœ€å‹‡æ•¢çš„å¥³å­©ã€ä¸€èª²ä¸­ï¼Œé¦¬æ‹‰æ‹‰æœ€ä¸»è¦çš„è¨´æ±‚æ˜¯ä»€éº¼ï¼Ÿ', opts:['çˆ­å–å¥³å­©å—æ•™æ¬Š','çˆ­å–æŠ•ç¥¨æ¬Š','ä¿è­·ç’°å¢ƒ','æ‹¯æ•‘æµæµªå‹•ç‰©'], a:'çˆ­å–å¥³å­©å—æ•™æ¬Š'},
        {id:14, type:'mc', q:'ã€ç¬¬ä¹èª²ã€‘é¢å°æŒ«æŠ˜ï¼Œä½œè€…å»ºè­°æˆ‘å€‘æ‡‰æŠ±æŒä½•ç¨®æ…‹åº¦ï¼Ÿ', opts:['æ€¨å¤©å°¤äºº','é€ƒé¿ç¾å¯¦','æ­£å‘æ€è€ƒ','ä¾è³´ä»–äºº'], a:'æ­£å‘æ€è€ƒ'},
        {id:15, type:'mc', q:'ã€ç¬¬åèª²ã€‘ä½œè€…åœ¨å±±ä¸­è½åˆ°äº†ä»€éº¼è²éŸ³è®“ä»–è¦ºå¾—æ‚…è€³ï¼Ÿ', opts:['è»Šè²','èŸ²é³´é³¥å«','å»£æ’­è²','äººçš„åµæ¶è²'], a:'èŸ²é³´é³¥å«'},
        {id:16, type:'mc', q:'ã€ç¬¬åä¸€èª²ã€‘ã€Œèˆ‡é”é§­é»‘ç†Šèµ°å…¥å±±æ—ã€æ–‡ä¸­ï¼Œä½œè€…å°é»‘ç†Šçš„æƒ…æ„Ÿç‚ºä½•ï¼Ÿ', opts:['ææ‡¼èˆ‡å­æƒ¡','å°Šæ•¬èˆ‡æ„Ÿæ¿€','å˜²ç¬‘èˆ‡è¼•è¦–','å†·æ¼ èˆ‡ç„¡è¦–'], a:'å°Šæ•¬èˆ‡æ„Ÿæ¿€'},
        {id:17, type:'mc', q:'ã€ç¬¬åäºŒèª²ã€‘é­¯æ¿±éœåœ¨è’å³¶ä¸Šé‡è¦‹çš„é‡äººæœ‹å‹ï¼Œä»–å°‡å…¶å–åç‚ºï¼Ÿ', opts:['æ˜ŸæœŸä¸€','æ˜ŸæœŸäº”','æ˜ŸæœŸå¤©','é­¯æ¿±éœäºŒä¸–'], a:'æ˜ŸæœŸäº”'},
        {id:18, type:'mc', q:'ã€å­—éŸ³ã€‘ä¸‹åˆ—ã€Œã€ä¸­çš„å­—ï¼Œä½•è€…è®€éŸ³æ­£ç¢ºï¼Ÿ', opts:['ã€Œä¾›ã€æ‡‰ï¼šã„ã„¨ã„¥','ã€Œè™•ã€ç½°ï¼šã„”ã„¨Ë‹','ã€Œå‰µã€å‚·ï¼šã„”ã„¨ã„¤Ë‹','ã€Œå¼·ã€è¿«ï¼šã„‘ã„§ã„¤Ë‡'], a:'ã€Œå¼·ã€è¿«ï¼šã„‘ã„§ã„¤Ë‡'},
        {id:19, type:'mc', q:'ã€å­—å½¢ã€‘ä¸‹åˆ—å“ªå€‹è©èªçš„ç”¨å­—å®Œå…¨æ­£ç¢ºï¼Ÿ', opts:['æç„¶å¤§æ‚Ÿ','æ…Œç„¶å¤§æ‚Ÿ','æç„¶å¤§èª¤','å…‰ç„¶å¤§æ‚Ÿ'], a:'æç„¶å¤§æ‚Ÿ'},
        {id:20, type:'mc', q:'ã€æˆèªã€‘å½¢å®¹ä¸€å€‹äººæ„å¿—å …å®šï¼Œä¸å› å¤±æ•—è€Œé€€ç¸®ã€‚', opts:['åŠé€”è€Œå»¢','è¶ŠæŒ«è¶Šå‹‡','å¾—æ„å¿˜å½¢','è‡ªæš´è‡ªæ£„'], a:'è¶ŠæŒ«è¶Šå‹‡'},
        {id:21, type:'mc', q:'ã€æˆèªã€‘ã€Œåè½å­«å±±ã€çš„æ„æ€æ˜¯ï¼Ÿ', opts:['è€ƒè©¦åˆæ ¼','ä½åœ¨å±±ä¸Š','è€ƒè©¦è½æ¦œ','åå­—åˆ»åœ¨å±±ä¸Š'], a:'è€ƒè©¦è½æ¦œ'},
        {id:22, type:'mc', q:'ã€ä¿®è¾­ã€‘ã€Œé¢¨å…’è¼•è¼•çš„å”±è‘—æ­Œã€‚ã€ä½¿ç”¨äº†å“ªç¨®ä¿®è¾­ï¼Ÿ', opts:['èª‡é£¾','è½‰åŒ–(æ“¬äºº)','æ’æ¯”','è¨­å•'], a:'è½‰åŒ–(æ“¬äºº)'},
        {id:23, type:'mc', q:'ã€ç•«å®¶çš„å¤©ç©ºã€‘é½Šç™½çŸ³åŸæœ¬æ˜¯åšä»€éº¼å·¥ä½œçš„ï¼Ÿ', opts:['éµåŒ ','æœ¨åŒ ','å»šå¸«','æ¼å¤«'], a:'æœ¨åŒ '},
        {id:24, type:'mc', q:'ã€ç¬¬åäºŒèª²ã€‘é­¯æ¿±éœåœ¨è’å³¶ä¸Šç”Ÿæ´»äº†å°‡è¿‘å¹¾å¹´ï¼Ÿ', opts:['3å¹´','10å¹´','28å¹´','50å¹´'], a:'28å¹´'},
        {id:25, type:'mc', q:'ã€å¥å‹ã€‘ã€Œèˆ‡å…¶......ä¸å¦‚......ã€æ˜¯ç”¨ä¾†è¡¨ç¤ºï¼Ÿ', opts:['å› æœé—œä¿‚','é¸æ“‡é—œä¿‚','æ¢ä»¶é—œä¿‚','å‡è¨­é—œä¿‚'], a:'é¸æ“‡é—œä¿‚'},
        {id:26, type:'mc', q:'ä¸‹åˆ—å“ªä¸€å€‹å­—çš„éƒ¨é¦–éŒ¯èª¤ï¼Ÿ', opts:['ã€Œå¯„ã€ï¼šå®€éƒ¨','ã€Œå‹‡ã€ï¼šåŠ›éƒ¨','ã€ŒæŒ«ã€ï¼šæ‰‹éƒ¨','ã€Œå³¶ã€ï¼šé³¥éƒ¨'], a:'ã€Œå³¶ã€ï¼šé³¥éƒ¨'}, // å³¶æ˜¯å±±éƒ¨
        {id:27, type:'mc', q:'ã€Œå´å¶‡ã€çš„æ„æ€æ˜¯ï¼Ÿ', opts:['å½¢å®¹è·¯é¢å¹³å¦','å½¢å®¹å±±è·¯é«˜ä½ä¸å¹³','å½¢å®¹æ°´æµæ¹æ€¥','å½¢å®¹å¿ƒæƒ…æ„‰å¿«'], a:'å½¢å®¹å±±è·¯é«˜ä½ä¸å¹³'},
        {id:28, type:'mc', q:'ã€ç¬¬åä¸€èª²ã€‘æ–‡ä¸­æåˆ°äººé¡æ‡‰è©²å¦‚ä½•å°å¾…å±±æ—ï¼Ÿ', opts:['å¤§é‡é–‹ç™¼','äº’ç›¸å°Šé‡ï¼Œå’Œå¹³å…±å­˜','æ•æ‰æ‰€æœ‰å‹•ç‰©','ç å…‰æ¨¹æœ¨ç¨®æª³æ¦”'], a:'äº’ç›¸å°Šé‡ï¼Œå’Œå¹³å…±å­˜'},
        {id:29, type:'mc', q:'ã€Œéœè¬ã€çš„æ„æ€èˆ‡ä¸‹åˆ—ä½•è€…ç›¸åï¼Ÿ', opts:['å®‰éœ','å–§é¬§','å¹½éœ','æ²‰éœ'], a:'å–§é¬§'},
        {id:30, type:'mc', q:'ã€ç¬¬ä¹èª²ã€‘ä¸‹åˆ—å“ªä½åäººæ˜¯ã€Œåœ¨æŒ«æŠ˜ä¸­æˆé•·ã€çš„å¥½ä¾‹å­ï¼Ÿ', opts:['æå®‰(æ›¾å¤±æ¥­å…­å¹´)','å«è‘—é‡‘æ¹¯åŒ™å‡ºç”Ÿçš„äºº','ä¸­æ¨‚é€çš„äºº','æœªç¶“åŠªåŠ›å°±æˆåŠŸçš„äºº'], a:'æå®‰(æ›¾å¤±æ¥­å…­å¹´)'},
        {id:31, type:'mc', q:'ä¸‹åˆ—å“ªä¸€å¥è©±å«æœ‰ã€Œé¼“å‹µã€çš„èªæ°£ï¼Ÿ', opts:['ä½ æ€éº¼é€™éº¼ç¬¨ï¼','é€™é»å°äº‹éƒ½åšä¸å¥½ã€‚','å¤±æ•—æ²’é—œä¿‚ï¼Œä¸‹æ¬¡å†åŠªåŠ›å°±å¥½ã€‚','æ”¾æ£„å§ï¼Œä½ åšä¸åˆ°çš„ã€‚'], a:'å¤±æ•—æ²’é—œä¿‚ï¼Œä¸‹æ¬¡å†åŠªåŠ›å°±å¥½ã€‚'},
        {id:32, type:'mc', q:'ã€Œè‚†è™ã€çš„æ„æ€æ˜¯ï¼Ÿ', opts:['ä»»æ„ä½œæƒ¡','å¹«åŠ©åˆ¥äºº','å››è™•éŠç©','å¤©æ°£å¾ˆå¥½'], a:'ä»»æ„ä½œæƒ¡'},
        {id:33, type:'mc', q:'ã€ç¬¬åèª²ã€‘ä½œè€…èªç‚ºå±±æ—åƒä»€éº¼ï¼Ÿ', opts:['ä¸€ä½åš´å²çš„è€å¸«','ä¸€ä½æ…ˆç¥¥çš„æ¯è¦ª','ä¸€å€‹åµé¬§çš„å¸‚å ´','ä¸€åº§å†°å†·çš„ç›£ç„'], a:'ä¸€ä½æ…ˆç¥¥çš„æ¯è¦ª'},
        {id:34, type:'mc', q:'ã€é–±è®€éšæ¢¯äºŒã€‘åˆ†äº«çš„é‡‘ç‰Œæ•…äº‹ç™¼ç”Ÿåœ¨ä»€éº¼æ¯”è³½ï¼Ÿ', opts:['å¥§é‹','ä¸–ç•Œç›ƒ','ç‰¹å¥§æœƒ(ç‰¹æ®Šå¥§æ—åŒ¹å…‹é‹å‹•æœƒ)','æ ¡æ…¶é‹å‹•æœƒ'], a:'ç‰¹å¥§æœƒ(ç‰¹æ®Šå¥§æ—åŒ¹å…‹é‹å‹•æœƒ)'},
        {id:35, type:'mc', q:'ä¸‹åˆ—è©èªä½•è€…æ˜¯ç”¨ä¾†å½¢å®¹ã€Œé½Šç™½çŸ³ã€çš„ç•«é¢¨ï¼Ÿ', opts:['é‡‘ç¢§è¼ç…Œ','æ¨¸å¯¦è‡ªç„¶','æŠ½è±¡é›£æ‡‚','é™°æ£®ææ€–'], a:'æ¨¸å¯¦è‡ªç„¶'},
        {id:36, type:'mc', q:'ã€Œä»–å› ç‚ºä¸€æ™‚çš„ç–å¿½ï¼Œå°è‡´å…¨ç›¤çš†è¼¸ã€‚ã€å¥ä¸­çš„ã€Œç–å¿½ã€å¯ä»¥æ›¿æ›ç‚ºï¼Ÿ', opts:['è¬¹æ…','å¤§æ„','åŠªåŠ›','è°æ˜'], a:'å¤§æ„'},
        {id:37, type:'mc', q:'ã€å­—éŸ³ã€‘ã€Œå‰µã€ä½œçš„è®€éŸ³ï¼Ÿ', opts:['ã„”ã„¨ã„¤','ã„”ã„¨ã„¤Ë‹','ã„˜ã„¤','ã„˜ã„¤Ë‹'], a:'ã„”ã„¨ã„¤Ë‹'},
        {id:38, type:'mc', q:'ã€å­—ç¾©ã€‘è’å³¶çš„ã€Œè’ã€æ„æ€æ˜¯ï¼Ÿ', opts:['æ…Œå¼µ','ååƒ»ã€ç„¡äººé–‹å¢¾','è±æ”¶','èªªè¬Š'], a:'ååƒ»ã€ç„¡äººé–‹å¢¾'},
        {id:39, type:'mc', q:'ä¸‹åˆ—ä½•è€…ä¸æ˜¯é­¯æ¿±éœåœ¨å³¶ä¸Šåšçš„äº‹ï¼Ÿ', opts:['è“‹æˆ¿å­','ç¨®éº¥å­','é–‹è¶…å•†','åšé™¶å™¨'], a:'é–‹è¶…å•†'},
        {id:40, type:'mc', q:'ã€ç¬¬åä¸€èª²ã€‘ã€Œé»‘ç†Šã€åœ¨å¸ƒè¾²æ—èªä¸­è¢«ç¨±ç‚ºä»€éº¼ï¼Ÿ', opts:['é”é§­(Tutum)','ç™¾æ­¥è›‡','é›²è±¹','å±±è±¬'], a:'é”é§­(Tutum)'},

        // é–±è®€æ¸¬é©— (41-50)
        {id:41, type:'read', group:'read1', passage:'ã€é–±è®€æ¸¬é©—ï¼šæ„›è¿ªç”Ÿèˆ‡é›»ç‡ˆã€‘\næ„›è¿ªç”Ÿåœ¨ç™¼æ˜é›»ç‡ˆçš„éç¨‹ä¸­ï¼Œç¶“æ­·äº†ä¸Šåƒæ¬¡çš„å¤±æ•—ã€‚æœ‰äººå˜²ç¬‘ä»–ï¼šã€Œä½ å·²ç¶“å¤±æ•—äº†ä¸€åƒæ¬¡äº†ï¼Œç‚ºä»€éº¼ä¸æ”¾æ£„ï¼Ÿã€æ„›è¿ªç”Ÿå»å¾®ç¬‘è‘—å›ç­”ï¼šã€Œæˆ‘æ²’æœ‰å¤±æ•—ï¼Œæˆ‘åªæ˜¯ç™¼ç¾äº†ä¸€åƒç¨®ä¸é©åˆåšç‡ˆçµ²çš„ææ–™ã€‚ã€é€™ç¨®å …æŒåˆ°åº•ã€æ­£å‘æ€è€ƒçš„ç²¾ç¥ï¼Œçµ‚æ–¼è®“ä»–é»äº®äº†ä¸–ç•Œã€‚', q:'æ„›è¿ªç”Ÿç™¼æ˜äº†ä»€éº¼ï¼Ÿ', opts:['é›»è©±','é›»ç‡ˆ','é£›æ©Ÿ','ç«è»Š'], a:'é›»ç‡ˆ'},
        {id:42, type:'read', group:'read1', q:'é¢å°åˆ¥äººçš„å˜²ç¬‘ï¼Œæ„›è¿ªç”Ÿçš„æ…‹åº¦æ˜¯ï¼Ÿ', opts:['ç”Ÿæ°£','æ”¾æ£„','æ­£å‘æ€è€ƒ','å¤§å“­'], a:'æ­£å‘æ€è€ƒ'},
        {id:43, type:'read', group:'read1', q:'é€™ç¯‡æ–‡ç« ä¸»è¦åœ¨å‹‰å‹µæˆ‘å€‘ï¼Ÿ', opts:['è¦æœ‰éŒ¢','è¦å …æŒåˆ°åº•','è¦è°æ˜','è¦é‹æ°£å¥½'], a:'è¦å …æŒåˆ°åº•'},
        {id:44, type:'read', group:'read1', q:'æ„›è¿ªç”Ÿèªç‚ºä»–çš„ã€Œå¤±æ•—ã€æ˜¯ï¼Ÿ', opts:['æµªè²»æ™‚é–“','ç™¼ç¾ä¸é©åˆçš„ææ–™','é‹æ°£ä¸å¥½','åˆ¥äººçš„éŒ¯'], a:'ç™¼ç¾ä¸é©åˆçš„ææ–™'},
        
        {id:45, type:'read', group:'read2', passage:'ã€é–±è®€æ¸¬é©—ï¼šæ¨¹çš„æ™ºæ…§ã€‘\næ£®æ—è£¡çš„æ¨¹æœ¨ï¼Œé›–ç„¶ä¸æœƒèªªè©±ï¼Œä½†å®ƒå€‘æ‡‚å¾—åˆä½œã€‚ç§‘å­¸å®¶ç™¼ç¾ï¼Œæ¨¹æœ¨çš„æ ¹éƒ¨æœƒåœ¨åœ°ä¸‹ç›¸é€£ï¼Œé€éçœŸèŒå‚³éé¤Šåˆ†ã€‚ç•¶ä¸€æ£µæ¨¹ç”Ÿç—…æˆ–å¤ªå°æ™‚ï¼Œå‘¨åœçš„å¤§æ¨¹æœƒåˆ†é€é¤Šåˆ†çµ¦å®ƒã€‚é€™å‘Šè¨´æˆ‘å€‘ï¼Œå¼·è€…æ‡‰è©²ç…§é¡§å¼±è€…ï¼Œäº’åŠ©åˆä½œæ‰èƒ½å…±å­˜ã€‚', q:'æ–‡ç« æåˆ°æ¨¹æœ¨é€éä»€éº¼å‚³éé¤Šåˆ†ï¼Ÿ', opts:['è‘‰å­','æ ¹éƒ¨èˆ‡çœŸèŒ','æ¨¹æ','é¢¨'], a:'æ ¹éƒ¨èˆ‡çœŸèŒ'},
        {id:46, type:'read', group:'read2', q:'ç•¶ä¸€æ£µæ¨¹ç”Ÿç—…æ™‚ï¼Œå‘¨åœçš„å¤§æ¨¹æœƒï¼Ÿ', opts:['æ¶å®ƒçš„é¤Šåˆ†','åˆ†é€é¤Šåˆ†çµ¦å®ƒ','ç½®ä¹‹ä¸ç†','æŠŠå®ƒæ¨å€’'], a:'åˆ†é€é¤Šåˆ†çµ¦å®ƒ'},
        {id:47, type:'read', group:'read2', q:'é€™ç¯‡æ–‡ç« æƒ³å‘Šè¨´æˆ‘å€‘çš„é“ç†æ˜¯ï¼Ÿ', opts:['é©è€…ç”Ÿå­˜','å¼±è‚‰å¼·é£Ÿ','äº’åŠ©åˆä½œ','ç¨å–„å…¶èº«'], a:'äº’åŠ©åˆä½œ'},

        {id:48, type:'read', group:'read3', passage:'ã€é–±è®€æ¸¬é©—ï¼šç¥å¥‡çš„è™è ã€‘\nè™è æ˜¯å”¯ä¸€æœƒé£›çš„å“ºä¹³é¡å‹•ç‰©ã€‚ç‰ å€‘é›–ç„¶è¦–åŠ›ä¸å¥½ï¼Œä½†è½åŠ›æ¥µä½³ã€‚è™è åœ¨é£›è¡Œæ™‚æœƒç™¼å‡ºè¶…éŸ³æ³¢ï¼Œç•¶è²æ³¢ç¢°åˆ°ç‰©é«”åå°„å›ä¾†ï¼Œç‰ å°±èƒ½åˆ¤æ–·å‰æ–¹éšœç¤™ç‰©çš„ä½ç½®èˆ‡å¤§å°ï¼Œé€™ç¨±ç‚ºã€Œå›è²å®šä½ã€ã€‚äººé¡æ¨¡ä»¿é€™å€‹åŸç†ï¼Œç™¼æ˜äº†é›·é”ã€‚', q:'è™è æ˜¯å±¬æ–¼å“ªä¸€é¡å‹•ç‰©ï¼Ÿ', opts:['é³¥é¡','æ˜†èŸ²','å“ºä¹³é¡','çˆ¬èŸ²é¡'], a:'å“ºä¹³é¡'},
        {id:49, type:'read', group:'read3', q:'è™è åˆ©ç”¨ä»€éº¼ä¾†åˆ¤æ–·æ–¹ä½ï¼Ÿ', opts:['è¦–åŠ›','å—…è¦º','å›è²å®šä½','è§¸è¦º'], a:'å›è²å®šä½'},
        {id:50, type:'read', group:'read3', q:'äººé¡æ¨¡ä»¿è™è ç™¼æ˜äº†ä»€éº¼ï¼Ÿ', opts:['é£›æ©Ÿ','é›·é”','æ½›æ°´è‰‡','æœ›é é¡'], a:'é›·é”'}
    ];

    // ç³»çµ±è®Šæ•¸
    let timer;
    let timeLeft = 40 * 60; // 40åˆ†é˜
    let quizStarted = false;

    // åˆå§‹åŒ–
    function init() {
        const form = document.getElementById('quiz-form');
        let currentGroup = '';

        questions.forEach((q, idx) => {
            // è™•ç†é–±è®€æ¸¬é©—æ–‡ç« é¡¯ç¤º
            if(q.type === 'read' && q.group !== currentGroup) {
                const p = document.createElement('div');
                p.className = 'reading-section';
                p.innerText = q.passage;
                form.appendChild(p);
                currentGroup = q.group;
            }

            const card = document.createElement('div');
            card.className = 'question-card';
            card.id = `card-${q.id}`;

            // é¡Œç›®æ¨™é¡Œ
            const title = document.createElement('div');
            title.className = 'question-text';
            title.innerText = `${idx + 1}. ${q.q} (2åˆ†)`;
            card.appendChild(title);

            // ç¨å¾Œä½œç­”
            const reviewLabel = document.createElement('label');
            reviewLabel.className = 'review-check';
            reviewLabel.innerHTML = `<input type="checkbox" onchange="toggleReview(${q.id})"> ç¨å¾Œä½œç­”`;
            card.appendChild(reviewLabel);

            // é¸é …
            const optsDiv = document.createElement('div');
            optsDiv.className = 'options-group';
            
            let options = q.type === 'tf' ? ['O', 'X'] : q.opts;
            options.forEach(opt => {
                const label = document.createElement('label');
                const radio = document.createElement('input');
                radio.type = 'radio';
                radio.name = `q${q.id}`;
                radio.value = opt;
                radio.onchange = updateStats;
                
                label.appendChild(radio);
                label.appendChild(document.createTextNode(opt));
                optsDiv.appendChild(label);
            });
            card.appendChild(optsDiv);
            form.appendChild(card);
        });
    }

    // é–‹å§‹æ¸¬é©—
    function startQuiz() {
        init();
        document.getElementById('start-screen').classList.add('hidden');
        document.getElementById('quiz-area').classList.remove('hidden');
        document.getElementById('footer-controls').classList.remove('hidden');
        quizStarted = true;
        
        timer = setInterval(() => {
            timeLeft--;
            updateTimerDisplay();
            checkTimeAlerts();
            if(timeLeft <= 0) {
                clearInterval(timer);
                alert('æ™‚é–“åˆ°ï¼ç³»çµ±å°‡è‡ªå‹•ç¹³å·ã€‚');
                submitQuiz(true);
            }
        }, 1000);
    }

    function updateTimerDisplay() {
        const m = Math.floor(timeLeft / 60).toString().padStart(2, '0');
        const s = (timeLeft % 60).toString().padStart(2, '0');
        document.getElementById('timer-box').innerText = `${m}:${s}`;
        
        if(timeLeft < 300) document.getElementById('timer-box').style.color = '#ff6b6b';
    }

    function checkTimeAlerts() {
        if(timeLeft === 15 * 60) alert('æé†’ï¼šè€ƒè©¦æ™‚é–“å‰©ä¸‹ 15 åˆ†é˜ï¼');
        if(timeLeft === 8 * 60) alert('æé†’ï¼šè€ƒè©¦æ™‚é–“å‰©ä¸‹ 8 åˆ†é˜ï¼è«‹åŠ å¿«é€Ÿåº¦ï¼');
        if(timeLeft === 5 * 60) alert('è­¦å‘Šï¼šè€ƒè©¦æ™‚é–“å‰©ä¸‹ 5 åˆ†é˜ï¼è«‹æª¢æŸ¥æ˜¯å¦æœ‰æœªå¡«å¯«çš„é¡Œç›®ã€‚');
    }

    // ç‹€æ…‹æ›´æ–°
    function updateStats() {
        let ans = 0, review = 0;
        questions.forEach(q => {
            if(document.querySelector(`input[name="q${q.id}"]:checked`)) ans++;
            if(document.querySelector(`#card-${q.id} .review-check input`).checked) review++;
        });
        document.getElementById('count-ans').innerText = ans;
        document.getElementById('count-unans').innerText = 50 - ans;
        document.getElementById('count-review').innerText = review;
    }

    function toggleReview(id) {
        const card = document.getElementById(`card-${id}`);
        const chk = card.querySelector('.review-check input');
        if(chk.checked) card.classList.add('review-marked');
        else card.classList.remove('review-marked');
        updateStats();
    }

    // ç¹³å·æª¢æŸ¥
    function preSubmitCheck() {
        let unans = [], reviews = [];
        questions.forEach((q, i) => {
            if(!document.querySelector(`input[name="q${q.id}"]:checked`)) unans.push(i+1);
            if(document.querySelector(`#card-${q.id} .review-check input`).checked) reviews.push(i+1);
        });

        let msg = "";
        if(unans.length > 0) msg += `âš ï¸ æ‚¨æœ‰ ${unans.length} é¡Œæœªä½œç­”ï¼\n`;
        if(reviews.length > 0) msg += `âš ï¸ æ‚¨æœ‰ ${reviews.length} é¡Œæ¨™è¨˜ç‚ºã€Œç¨å¾Œä½œç­”ã€ï¼\n`;
        
        if(msg) {
            msg += "\nç¢ºå®šè¦ç¹³å·å—ï¼Ÿ";
            if(confirm(msg)) submitQuiz();
        } else {
            if(confirm("ç¢ºå®šè¦ç¹³å·é€å‡ºå—ï¼Ÿ")) submitQuiz();
        }
    }

    // ç¹³å·é‚è¼¯
    function submitQuiz(force = false) {
        clearInterval(timer);
        window.scrollTo(0,0);
        document.getElementById('footer-controls').classList.add('hidden'); // Hide footer
        document.getElementById('timer-box').style.display = 'none';

        let score = 0;
        let resultData = [["é¡Œè™Ÿ", "é¡Œç›®", "æ‚¨çš„ç­”æ¡ˆ", "æ­£ç¢ºç­”æ¡ˆ", "çµæœ"]];
        
        questions.forEach((q, idx) => {
            const selected = document.querySelector(`input[name="q${q.id}"]:checked`);
            const userVal = selected ? selected.value : "æœªä½œç­”";
            const isCorrect = userVal === q.a;
            
            const card = document.getElementById(`card-${q.id}`);
            const inputs = card.querySelectorAll('input');
            inputs.forEach(i => i.disabled = true); // Disable inputs

            if(isCorrect) {
                score += 2;
            } else {
                card.classList.add('wrong-answer-card');
                const correctDiv = document.createElement('div');
                correctDiv.className = 'correct-answer-text';
                correctDiv.innerText = `âŒ ç­”éŒ¯äº†ï¼æ­£ç¢ºç­”æ¡ˆæ˜¯ï¼š${q.a}`;
                card.appendChild(correctDiv);

                // Add to CSV data
                resultData.push([idx+1, q.q, userVal, q.a, "éŒ¯èª¤"]);
            }
        });

        // é¡¯ç¤ºçµæœ
        document.getElementById('result-area').classList.remove('hidden');
        document.getElementById('final-score').innerText = `ç¸½åˆ†ï¼š${score} åˆ†`;
        
        // è‡ªå‹•ä¸‹è¼‰ CSV
        if(resultData.length > 1) { // å¦‚æœæœ‰éŒ¯é¡Œ
            downloadCSV(resultData);
        }
    }

    function downloadCSV(data) {
        let csvContent = "data:text/csv;charset=utf-8,\uFEFF";
        data.forEach(row => {
            // è™•ç†é€—è™Ÿé¿å… CSV æ ¼å¼éŒ¯èª¤
            let cleanRow = row.map(item => `"${String(item).replace(/"/g, '""')}"`); 
            csvContent += cleanRow.join(",") + "\r\n";
        });
        
        const link = document.createElement("a");
        link.setAttribute("href", encodeURI(csvContent));
        link.setAttribute("download", "exam_result.csv");
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
    }

    // ç®¡ç†å“¡æŸ¥çœ‹ç­”æ¡ˆ
    function showAnswerKey() {
        const pwd = prompt("è«‹è¼¸å…¥å¯†ç¢¼ï¼š");
        if(pwd === "1234") {
            let key = "ã€åƒè€ƒç­”æ¡ˆã€‘\n";
            questions.forEach((q, i) => {
                key += `${i+1}.${q.a}  `;
                if((i+1)%5 === 0) key += "\n";
            });
            alert(key);
        } else {
            alert("å¯†ç¢¼éŒ¯èª¤ï¼");
        }
    }
</script>

</body>
</html>