<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>113å­¸å¹´-åº·è»’(äº”ä¸Š)åœ‹èªç·šä¸ŠæœŸæœ«æ¸¬é©—ç³»çµ±_1.12.16.25</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://cdn.jsdelivr.net/npm/xlsx-js-style@1.2.0/dist/xlsx-bundle.min.js"></script>

    <style>
        /* å®šç¾©è‰²ç³» */
        :root {
            --color-main: #4B9DA9;    /* ä¸»è‰² */
            --color-light: #91C6BC;   /* æ·ºè‰²è£é£¾ */
            --color-bg: #F6F3C2;      /* èƒŒæ™¯è‰² */
            --color-accent: #E37434;  /* å¼·èª¿è‰² (æŒ‰éˆ•/é‡é») */
        }
        
        body {
            background-color: var(--color-bg);
            font-family: "Microsoft JhengHei", "Heiti TC", sans-serif; /* å¾®è»Ÿæ­£é»‘é«” */
        }

        /* è‡ªå®šç¾©æ¨£å¼é¡åˆ¥ */
        .btn-accent {
            background-color: var(--color-accent);
            color: white;
            transition: all 0.3s;
        }
        .btn-accent:hover {
            background-color: #c9632a;
            transform: scale(1.05);
        }

        .question-card {
            transition: all 0.3s ease;
        }

        /* æœªä½œç­”æ™‚çš„éœ‡å‹•èˆ‡ç´…æ¡†æ•ˆæœ */
        .unanswered-highlight {
            border: 2px solid var(--color-accent) !important;
            box-shadow: 0 0 15px rgba(227, 116, 52, 0.6);
            animation: shake 0.5s;
        }

        @keyframes shake {
            0% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            50% { transform: translateX(5px); }
            75% { transform: translateX(-5px); }
            100% { transform: translateX(0); }
        }

        /* ç­”æ¡ˆç‹€æ…‹æ¨£å¼ */
        .correct-ans { color: #166534; font-weight: bold; background-color: #dcfce7; border-color: #166534; }
        .wrong-ans { color: #991b1b; text-decoration: line-through; background-color: #fee2e2; border-color: #991b1b; }
        
        /* éš±è—å…ƒç´  */
        .hidden { display: none !important; }
    </style>
</head>
<body class="flex flex-col min-h-screen">

    <header class="bg-[#4B9DA9] text-white shadow-lg fixed w-full top-0 z-50">
        <div class="container mx-auto px-4 h-16 flex items-center justify-between">
            <h1 class="text-lg md:text-2xl font-bold truncate">113å­¸å¹´-åº·è»’(äº”ä¸Š)åœ‹èªç·šä¸ŠæœŸæœ«æ¸¬é©—ç³»çµ±_1.12.16.25</h1>
            <div id="timerDisplay" class="hidden text-xl font-mono font-bold bg-white text-[#4B9DA9] px-4 py-1 rounded shadow-inner">
                40:00
            </div>
        </div>
    </header>

    <main class="container mx-auto px-4 mt-24 mb-40 flex-grow">
        
        <div id="startScreen" class="flex flex-col items-center justify-center min-h-[60vh] text-center animate-fade-in">
            <div class="bg-white p-8 rounded-3xl shadow-xl max-w-2xl w-full border-t-8 border-[#4B9DA9]">
                <h2 class="text-3xl font-bold text-[#4B9DA9] mb-6">æœŸæœ«è€ƒæº–å‚™å¥½äº†å—ï¼Ÿ</h2>
                
                <div class="text-left text-gray-700 mb-8 space-y-3 bg-[#F6F3C2] p-6 rounded-xl">
                    <p class="flex items-center"><span class="text-xl mr-2">ğŸ“š</span> <strong>ç¯„åœï¼š</strong> åº·è»’äº”ä¸Š ç¬¬ä¸ƒèª²è‡³ç¬¬åäºŒèª²</p>
                    <p class="flex items-center"><span class="text-xl mr-2">â±ï¸</span> <strong>æ™‚é–“ï¼š</strong> 40 åˆ†é˜ (å€’æ•¸è¨ˆæ™‚)</p>
                    <p class="flex items-center"><span class="text-xl mr-2">ğŸ“</span> <strong>é¡Œæ•¸ï¼š</strong> 50 é¡Œ (æ»¿åˆ† 100 åˆ†)</p>
                    <p class="flex items-center"><span class="text-xl mr-2">ğŸ’¡</span> <strong>é¡Œå‹ï¼š</strong> å­—éŸ³å­—å½¢ã€æˆèªã€æ”¹éŒ¯ã€é–±è®€æ¸¬é©—</p>
                </div>
                
                <button onclick="window.startExam()" class="btn-accent text-2xl font-bold py-4 px-16 rounded-full shadow-lg mb-4">
                    é–‹å§‹ä½œç­”
                </button>
                
                <div class="mt-2 text-sm text-gray-500">
                    è³‡æ–™ä¾†æºï¼šåº·è»’ç‰ˆåœ‹å°äº”å¹´ç´šä¸Šå­¸æœŸæ­·å±†è€ƒå¤é¡Œ
                </div>

                <div class="mt-10 pt-6 border-t border-gray-200">
                    <button onclick="window.toggleTeacherZone()" class="text-gray-400 hover:text-[#4B9DA9] text-sm underline">
                        è€å¸«/å®¶é•·å°ˆå€ (è€ƒé¡Œä¸‹è¼‰/ä¸Šå‚³) ğŸ”’
                    </button>
                    <div id="teacherZone" class="hidden mt-4 p-4 bg-gray-50 rounded border border-gray-300 text-left">
                        <h3 class="font-bold text-gray-700 mb-2">ğŸ’¾ è€ƒé¡Œè³‡æ–™ç®¡ç† (JSON)</h3>
                        <div class="flex gap-4">
                            <button onclick="window.downloadQuestions()" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 shadow">
                                ğŸ“¥ ä¸‹è¼‰ç›®å‰è€ƒé¡Œ
                            </button>
                            <label class="bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600 shadow cursor-pointer">
                                ğŸ“¤ ä¸Šå‚³æ–°è€ƒé¡Œ
                                <input type="file" id="uploadFile" onchange="window.uploadQuestions(this)" class="hidden" accept=".json">
                            </label>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="examScreen" class="hidden">
            <div id="questionsContainer" class="space-y-6">
                </div>
            </div>
    </main>

    <footer id="statsFooter" class="fixed bottom-0 left-0 w-full bg-white shadow-[0_-4px_10px_rgba(0,0,0,0.1)] h-20 hidden z-40 border-t-4 border-[#4B9DA9]">
        <div class="container mx-auto h-full px-4 flex items-center justify-between relative">
            
            <div class="flex flex-col md:flex-row gap-1 md:gap-6 text-sm md:text-base font-bold text-gray-700">
                <div class="flex gap-4">
                    <span>ç¸½é¡Œ: <span id="totalCount" class="text-black">50</span></span>
                    <span>å·²ç­”: <span id="answeredCount" class="text-green-600">0</span></span>
                </div>
                <div class="flex gap-4">
                    <span>æœªç­”: <span id="unansweredCount" class="text-red-500">50</span></span>
                    <span class="bg-yellow-100 px-2 rounded text-yellow-700 text-xs md:text-sm flex items-center">ğŸ“Œ ç¨å¾Œ: <span id="markCount" class="ml-1">0</span></span>
                </div>
            </div>

            <div class="absolute left-1/2 top-1/2 transform -translate-x-1/2 -translate-y-1/2">
                <button onclick="window.attemptSubmit()" class="btn-accent text-lg md:text-xl font-bold py-2 px-8 rounded-full shadow-lg border-2 border-white whitespace-nowrap">
                    ç¹³å·é€å‡º
                </button>
            </div>

            <div class="text-xs text-gray-400 hidden md:block">
                Ver 1.12.16.25
            </div>
        </div>
    </footer>

    <script>
        // --- é¡Œç›®è³‡æ–™åº« (å…§å»º 50 é¡Œåº·è»’äº”ä¸Šç¯„åœ) ---
        const defaultQuestions = [
            // ç¬¬ä¸ƒèª²ï¼šç‚ºç”Ÿå‘½æ‰¾å‡ºå£
            { id: 1, unit: "ç¬¬ä¸ƒèª²", type: "å­—éŸ³", q: "ä¸‹åˆ—ã€Œã€ä¸­çš„å­—ï¼Œæ³¨éŸ³ä½•è€…æ­£ç¢ºï¼Ÿ", options: ["ã€Œç¸«ã€éš™ï¼šã„ˆã„¥ËŠ", "ã€ŒèŒã€å£¯ï¼šã„“ã„¨ã„›ËŠ", "å …ã€Œæ¯…ã€ï¼šã„§Ë‹", "ã€Œé€™ã€è£¡ï¼šã„“ã„œË‹"], ans: 3, explanation: "ç¸«éš™(ã„ˆã„¥Ë‹)ã€èŒå£¯(ã„“ã„¨ã„›ËŠ)ã€é€™è£¡(ã„“ã„œË‹)ã€‚å …æ¯…(ã„§Ë‹)æ­£ç¢ºã€‚" },
            { id: 2, unit: "ç¬¬ä¸ƒèª²", type: "æ”¹éŒ¯å­—", q: "è«‹æ‰¾å‡ºå¥ä¸­çš„éŒ¯åˆ¥å­—ï¼šã€Œé€™æ ªæ¤ç‰©å±•ç¾äº†å …å¼·çš„ç”Ÿä¾–åŠ›ã€‚ã€", options: ["æ¤", "å±•", "ä¾–", "åŠ›"], ans: 3, explanation: "æ‡‰ç‚ºç”Ÿã€Œå‘½ã€åŠ›ã€‚" },
            { id: 3, unit: "ç¬¬ä¸ƒèª²", type: "æˆèª", q: "ã€Œé€™è£¡èŠ±è‰é•·å¾—â–¡â–¡â–¡â–¡ï¼Œå……æ»¿ç”Ÿæ°£ã€‚ã€ç©ºæ ¼æ‡‰å¡«ï¼Ÿ", options: ["ç”Ÿæ©Ÿå‹ƒå‹ƒ", "æ­»æ°£æ²‰æ²‰", "å¥„å¥„ä¸€æ¯", "ç„¡ç²¾æ‰“é‡‡"], ans: 1, explanation: "ç”Ÿæ©Ÿå‹ƒå‹ƒï¼šå½¢å®¹å……æ»¿ç”Ÿå‘½åŠ›ã€‚" },
            { id: 4, unit: "ç¬¬ä¸ƒèª²", type: "é–±è®€", q: "ä½œè€…åœ¨ç‰†è§’ç™¼ç¾éæ´²å ‡ï¼Œé€™å€‹æ•…äº‹ä¸»è¦å‘Šè¨´æˆ‘å€‘ä»€éº¼ï¼Ÿ", options: ["è¦å¤šç¨®èŠ±", "ç‰†è§’å¾ˆé«’", "ç”Ÿå‘½æœƒè‡ªå·±å°‹æ‰¾å‡ºè·¯", "ä¸è¦äº‚ä¸Ÿåƒåœ¾"], ans: 3, explanation: "ä¸»æ—¨ç‚ºç”Ÿå‘½åœ¨é€†å¢ƒä¸­ä»æœƒåŠªåŠ›ç”Ÿå­˜ã€‚" },
            { id: 5, unit: "ç¬¬ä¸ƒèª²", type: "è©èª", q: "ã€Œé€™é …è¨­è¨ˆååˆ†â–¡â–¡ï¼Œè§£æ±ºäº†å¤šå¹´çš„å•é¡Œã€‚ã€", options: ["å¥§å¦™", "å·§å¦™", "å¥‡å¦™", "ç¾å¦™"], ans: 2, explanation: "å·§å¦™ï¼šç²¾å·§é«˜æ˜ã€‚" },
            { id: 6, unit: "ç¬¬ä¸ƒèª²", type: "å­—å½¢", q: "ã€Œç¸«ã€éš™çš„éƒ¨é¦–æ˜¯ä»€éº¼ï¼Ÿ", options: ["ç³¸", "é€¢", "è¾¶", "åŠ"], ans: 1, explanation: "ç¸«æ˜¯ç³¸éƒ¨ã€‚" },
            { id: 7, unit: "ç¬¬ä¸ƒèª²", type: "ç›¸åè©", q: "ã€Œå …æ¯…ã€çš„ç›¸åè©æ˜¯ï¼Ÿ", options: ["å‰›å¼·", "è»Ÿå¼±", "å …æŒ", "æœæ–·"], ans: 2, explanation: "å …æ¯…æ„æŒ‡å‰›å¼·ï¼Œç›¸åç‚ºè»Ÿå¼±ã€‚" },
            
            // ç¬¬å…«èª²ï¼šæœ€å‹‡æ•¢çš„å¥³å­©
            { id: 8, unit: "ç¬¬å…«èª²", type: "äººç‰©", q: "æœ¬èª²ä¸»è§’é¦¬æ‹‰æ‹‰ä¾†è‡ªå“ªå€‹åœ‹å®¶ï¼Ÿ", options: ["ç¾åœ‹", "å·´åŸºæ–¯å¦", "å°åº¦", "è‹±åœ‹"], ans: 2, explanation: "é¦¬æ‹‰æ‹‰ä¾†è‡ªå·´åŸºæ–¯å¦ã€‚" },
            { id: 9, unit: "ç¬¬å…«èª²", type: "æ³¨éŸ³", q: "ã€Œæ¬Šã€åˆ©çš„æ³¨éŸ³æ˜¯ï¼Ÿ", options: ["ã„‘ã„©ã„¢", "ã„‘ã„©ã„¢ËŠ", "ã„‘ã„©ã„¢Ë‡", "ã„‘ã„©ã„¢Ë‹"], ans: 2, explanation: "æ¬Šï¼šã„‘ã„©ã„¢ËŠã€‚" },
            { id: 10, unit: "ç¬¬å…«èª²", type: "éƒ¨é¦–", q: "ã€Œæã€æ€–çš„ææ˜¯ä»€éº¼éƒ¨é¦–ï¼Ÿ", options: ["å·¥", "å‡¡", "å¿ƒ", "åŠ›"], ans: 3, explanation: "ææ˜¯å¿ƒéƒ¨ã€‚" },
            { id: 11, unit: "ç¬¬å…«èª²", type: "ä¿®è¾­", q: "ã€Œæ›¸æœ¬å’Œç­†æ˜¯æˆ‘å€‘æœ€å¼·å¤§çš„æ­¦å™¨ã€‚ã€é‹ç”¨äº†ä½•ç¨®ä¿®è¾­ï¼Ÿ", options: ["æ“¬äºº", "è­¬å–»", "èª‡é£¾", "å€Ÿä»£"], ans: 2, explanation: "å°‡æ›¸ç­†æ¯”å–»ç‚ºæ­¦å™¨ã€‚" },
            { id: 12, unit: "ç¬¬å…«èª²", type: "å­—ç¾©", q: "ã€Œå‰å¥ªã€çš„æ„æ€æ˜¯ï¼Ÿ", options: ["çµ¦äºˆ", "å¼·åˆ¶å¥ªå»", "äº’ç›¸äº¤æ›", "æ”¾æ£„"], ans: 2, explanation: "å¼·åˆ¶å¥ªå»æ¬Šåˆ©æˆ–è²¡ç‰©ã€‚" },
            { id: 13, unit: "ç¬¬å…«èª²", type: "æ”¹éŒ¯å­—", q: "ã€Œé€™äº›æä½ˆä»½å­å¨è„…æ‘æ°‘ã€‚ã€å“ªè£¡æœ‰éŒ¯å­—ï¼Ÿ", options: ["æ", "ä½ˆ", "ä»½", "å¨"], ans: 2, explanation: "æ‡‰ç‚ºæã€Œæ€–ã€ã€‚" },
            { id: 14, unit: "ç¬¬å…«èª²", type: "é–±è®€", q: "é¦¬æ‹‰æ‹‰çˆ­å–çš„æ˜¯ä»€éº¼æ¬Šåˆ©ï¼Ÿ", options: ["ç©éŠæˆ²çš„æ¬Šåˆ©", "å—æ•™è‚²çš„æ¬Šåˆ©", "åƒç³–æœçš„æ¬Šåˆ©", "ä¸ç”¨è€ƒè©¦çš„æ¬Šåˆ©"], ans: 2, explanation: "å¥³å­©å—æ•™è‚²çš„æ¬Šåˆ©ã€‚" },
            
            // ç¬¬ä¹èª²ï¼šåœ¨æŒ«æŠ˜ä¸­æˆé•·
            { id: 15, unit: "ç¬¬ä¹èª²", type: "äººç‰©", q: "æœ¬èª²ä»‹ç´¹çš„åäººæ˜¯èª°ï¼Ÿ", options: ["æ„›è¿ªç”Ÿ", "æ—è‚¯", "è¯ç››é “", "åœ‹çˆ¶"], ans: 2, explanation: "ç¾åœ‹ç¸½çµ±æ—è‚¯ã€‚" },
            { id: 16, unit: "ç¬¬ä¹èª²", type: "æˆèª", q: "å½¢å®¹ã€Œæ„å¿—å‰›å¼·ï¼Œé›–å—ç›¡æŒ«æŠ˜ä¹Ÿä¸å±ˆæœã€çš„æˆèªï¼Ÿ", options: ["ç™¾æŠ˜ä¸æ’“", "ä¸€æ„å­¤è¡Œ", "åƒæ–¹ç™¾è¨ˆ", "ç™¾æˆ°ç™¾å‹"], ans: 1, explanation: "ç™¾æŠ˜ä¸æ’“ã€‚" },
            { id: 17, unit: "ç¬¬ä¹èª²", type: "å­—éŸ³", q: "ä¸ã€Œåƒ…ã€çš„è®€éŸ³ï¼Ÿ", options: ["ã„ã„§ã„£", "ã„ã„§ã„£Ë‡", "ã„ã„§ã„¥", "ã„ã„§ã„¥Ë‡"], ans: 2, explanation: "åƒ…ï¼šã„ã„§ã„£Ë‡ã€‚" },
            { id: 18, unit: "ç¬¬ä¹èª²", type: "æ”¹éŒ¯å­—", q: "ã€Œä»–ç¶“æ­´äº†ç„¡æ•¸æ¬¡å¤±æ•—æ‰æˆåŠŸã€‚ã€éŒ¯å­—æ˜¯ï¼Ÿ", options: ["ç¶“", "æ­´", "ç„¡", "æ•¸"], ans: 2, explanation: "æ‡‰ç‚ºç¶“ã€Œæ­·ã€ã€‚" },
            { id: 19, unit: "ç¬¬ä¹èª²", type: "è©èª", q: "ã€Œç£¨éŠã€çš„æ„æ€æ˜¯ï¼Ÿ", options: ["é›éŠã€è€ƒé©—", "æŠ˜ç£¨", "ç·´ç¿’", "ç©è€"], ans: 1, explanation: "åœ¨è‰±é›£å›°è‹¦çš„ç’°å¢ƒä¸­é›éŠã€‚" },
            { id: 20, unit: "ç¬¬ä¹èª²", type: "å¥å‹", q: "ã€Œèˆ‡å…¶â€¦â€¦ä¸å¦‚â€¦â€¦ã€æ˜¯ä»€éº¼è¤‡å¥ï¼Ÿ", options: ["å› æœ", "è½‰æŠ˜", "é¸æ“‡", "éé€²"], ans: 3, explanation: "é¸æ“‡è¤‡å¥ã€‚" },
            { id: 21, unit: "ç¬¬ä¹èª²", type: "å­—å½¢", q: "ã€ŒæŒ«ã€æŠ˜çš„æŒ«ï¼Œéƒ¨é¦–æ˜¯ï¼Ÿ", options: ["åœŸ", "æ‰‹", "å", "äºº"], ans: 2, explanation: "æ‰‹éƒ¨ã€‚" },

            // ç¬¬åèª²ï¼šå±±ä¸­å¯„æƒ…
            { id: 22, unit: "ç¬¬åèª²", type: "è©ç¾©", q: "ã€Œéœè¬ã€çš„æ„æ€æ˜¯ï¼Ÿ", options: ["ç†±é¬§", "å®‰éœ", "ç¥ç§˜", "å¿«é€Ÿ"], ans: 2, explanation: "éœè¬ï¼šå®‰éœã€‚" },
            { id: 23, unit: "ç¬¬åèª²", type: "å­—éŸ³", q: "èœ¿ã€Œèœ’ã€çš„è®€éŸ³ï¼Ÿ", options: ["ã„§ã„¢ËŠ", "ã„‰ã„¢Ë‹", "ã„Šã„§ã„¥ËŠ", "ã„’ã„§ã„¢ËŠ"], ans: 1, explanation: "èœ¿èœ’ï¼šã„¨ã„¢ ã„§ã„¢ËŠã€‚" },
            { id: 24, unit: "ç¬¬åèª²", type: "å­—å½¢", q: "ä¸‹åˆ—å“ªä¸€å€‹å­—æ˜¯ã€Œå±±ã€éƒ¨ï¼Ÿ", options: ["å¹½", "å¯†", "å²³", "æ­²"], ans: 3, explanation: "å²³æ˜¯å±±éƒ¨ã€‚" },
            { id: 25, unit: "ç¬¬åèª²", type: "ä¿®è¾­", q: "ã€Œå±±é¢¨å¹ä¾†ï¼Œæ¨¹è‘‰æ²™æ²™ä½œéŸ¿ï¼Œåƒæ˜¯åœ¨ç«Šç«Šç§èªã€‚ã€ä¿®è¾­æ˜¯ï¼Ÿ", options: ["è¨­å•", "æ“¬äºº", "å¼•ç”¨", "æ˜ è¥¯"], ans: 2, explanation: "æ“¬äººï¼ˆç«Šç«Šç§èªï¼‰ã€‚" },
            { id: 26, unit: "ç¬¬åèª²", type: "æˆèª", q: "ã€Œäººè²é¼æ²¸ã€çš„æ„æ€æ˜¯ï¼Ÿ", options: ["éå¸¸å®‰éœ", "äººè²åµé›œ", "é‹å­ç…®é–‹", "éŸ³æ¨‚å¥½è½"], ans: 2, explanation: "å½¢å®¹äººè²å˜ˆé›œï¼Œåƒæ°´ç…®æ²¸ä¸€æ¨£ã€‚" },
            { id: 27, unit: "ç¬¬åèª²", type: "æ”¹éŒ¯å­—", q: "ã€Œé€™åº§æ£®æ—ååˆ†å¹½éœï¼Œé©åˆæ•£å¸ƒã€‚ã€éŒ¯å­—æ˜¯ï¼Ÿ", options: ["å¹½", "éœ", "æ•£", "å¸ƒ"], ans: 4, explanation: "æ•£ã€Œæ­¥ã€ã€‚" },
            { id: 28, unit: "ç¬¬åèª²", type: "å¤šéŸ³å­—", q: "ä¸‹åˆ—ã€Œã€ä¸­è®€éŸ³ä½•è€…æ­£ç¢ºï¼Ÿ", options: ["ã€Œé‡ã€æ–°ï¼šã„“ã„¨ã„¥Ë‹", "ã€Œç‚ºã€é›£ï¼šã„¨ã„ŸË‹", "ã€Œæ¨‚ã€è¶£ï¼šã„Œã„œË‹", "ã€Œç©ºã€ç™½ï¼šã„ã„¨ã„¥"], ans: 3, explanation: "é‡æ–°(ã„”ã„¨ã„¥ËŠ)ã€ç‚ºé›£(ã„¨ã„ŸËŠ)ã€ç©ºç™½(ã„ã„¨ã„¥Ë‹)ã€‚æ¨‚è¶£(ã„Œã„œË‹)æ­£ç¢ºã€‚" },

            // ç¬¬åä¸€èª²ï¼šèˆ‡é”é§­é»‘ç†Šèµ°å…¥å±±æ—
            { id: 29, unit: "ç¬¬åä¸€èª²", type: "è©èª", q: "ã€Œç€•è‡¨ã€çš„æ„æ€æ˜¯ï¼Ÿ", options: ["é é›¢", "æ¥è¿‘ã€å°‡è¦", "æ”¾æ£„", "æŠµæŠ—"], ans: 2, explanation: "ç€•è‡¨ï¼šè‡¨è¿‘ã€‚" },
            { id: 30, unit: "ç¬¬åä¸€èª²", type: "å­—éŸ³", q: "ã€Œå·¡ã€å®ˆå“¡çš„è®€éŸ³ï¼Ÿ", options: ["ã„’ã„©ã„£ËŠ", "ã„’ã„©ã„£Ë‹", "ã„•ã„¨ã„£ËŠ", "ã„™ã„¨ã„£ËŠ"], ans: 1, explanation: "å·¡ï¼šã„’ã„©ã„£ËŠã€‚" },
            { id: 31, unit: "ç¬¬åä¸€èª²", type: "å…§å®¹", q: "èª²æ–‡ä¸­çš„ã€Œé”é§­ã€æŒ‡çš„æ˜¯ï¼Ÿ", options: ["ä¸€ä½çµäºº", "ä¸€éš»å°ç£é»‘ç†Š", "ä¸€åº§å±±", "ä¸€æ¢æ²³"], ans: 2, explanation: "å°ç£é»‘ç†Šçš„åå­—ã€‚" },
            { id: 32, unit: "ç¬¬åä¸€èª²", type: "æ”¹éŒ¯å­—", q: "ã€Œä»–åœ¨æ£®æ—è¨­ä¸‹é™·äº•ã€‚ã€éŒ¯å­—æ˜¯ï¼Ÿ", options: ["æ£®", "æ—", "é™·", "äº•"], ans: 4, explanation: "é™·ã€Œé˜±ã€ã€‚" },
            { id: 33, unit: "ç¬¬åä¸€èª²", type: "æˆèª", q: "ã€Œé€™è£¡çš„ç”Ÿæ…‹è±å¯Œï¼Œç‰©ç¨®â–¡â–¡ã€‚ã€", options: ["ç¹å¤š", "ç¨€å°‘", "å–®èª¿", "æ¯ç«­"], ans: 1, explanation: "ç‰©ç¨®ç¹å¤šã€‚" },
            { id: 34, unit: "ç¬¬åä¸€èª²", type: "å­—å½¢", q: "ã€Œè¹¤ã€è·¡çš„éƒ¨é¦–ï¼Ÿ", options: ["è¶³", "ä»", "æ­¢", "èº«"], ans: 1, explanation: "è¶³éƒ¨ã€‚" },
            { id: 35, unit: "ç¬¬åä¸€èª²", type: "é–±è®€", q: "ä½œè€…å¸Œæœ›æˆ‘å€‘å¦‚ä½•å°å¾…é»‘ç†Šï¼Ÿ", options: ["æ•æ‰ç‰ å€‘", "å°Šé‡ä¸¦ä¿è­·", "æŠŠå®ƒç•¶å¯µç‰©", "è¶•å‡ºæ£®æ—"], ans: 2, explanation: "å°Šé‡ç”Ÿå‘½ï¼Œä¿è­·ç”Ÿæ…‹ã€‚" },

            // ç¬¬åäºŒèª²ï¼šè’å³¶ä¸Šçš„åœ‹ç‹
            { id: 36, unit: "ç¬¬åäºŒèª²", type: "å¸¸è­˜", q: "æœ¬èª²æ”¹å¯«è‡ªå“ªæœ¬å°èªªï¼Ÿ", options: ["æ ¼åˆ—ä½›éŠè¨˜", "é­¯æ¿±éœæ¼‚æµè¨˜", "é‡‘éŠ€å³¶", "è¥¿éŠè¨˜"], ans: 2, explanation: "é­¯æ¿±éœæ¼‚æµè¨˜ã€‚" },
            { id: 37, unit: "ç¬¬åäºŒèª²", type: "æ³¨éŸ³", q: "ã€ŒæŸµã€æ¬„çš„è®€éŸ³ï¼Ÿ", options: ["ã„•ã„¢", "ã„“ã„šË‹", "ã„˜ã„œË‹", "ã„†ã„¥ËŠ"], ans: 2, explanation: "æŸµï¼šã„“ã„šË‹ã€‚" },
            { id: 38, unit: "ç¬¬åäºŒèª²", type: "è©ç¾©", q: "ã€Œç°¡é™‹ã€çš„æ„æ€æ˜¯ï¼Ÿ", options: ["ç°¡å–®ä¸å®Œå‚™", "è±ªè¯", "ä¹¾æ·¨", "è¤‡é›œ"], ans: 1, explanation: "è¨­å‚™ç°¡å–®ç²—é™‹ã€‚" },
            { id: 39, unit: "ç¬¬åäºŒèª²", type: "å­—éŸ³", q: "ã€Œè™•ã€å¢ƒçš„è™•è®€éŸ³ï¼Ÿ", options: ["ã„”ã„¨Ë‹", "ã„”ã„¨Ë‡", "ã„˜ã„¨Ë‹", "ã„˜ã„¨Ë‡"], ans: 2, explanation: "è™•(ã„”ã„¨Ë‡)å¢ƒï¼šè™•æ–¼æŸç¨®ç‹€æ³ã€‚" },
            { id: 40, unit: "ç¬¬åäºŒèª²", type: "æ”¹éŒ¯å­—", q: "ã€Œä»–æ„Ÿåˆ°ååˆ†å­¤ç¨èˆ‡çµ•å¿˜ã€‚ã€éŒ¯å­—æ˜¯ï¼Ÿ", options: ["å­¤", "ç¨", "çµ•", "å¿˜"], ans: 4, explanation: "çµ•ã€Œæœ›ã€ã€‚" },
            { id: 41, unit: "ç¬¬åäºŒèª²", type: "ä¿®è¾­", q: "ã€Œæˆ‘æ˜¯é€™è£¡çš„åœ‹ç‹ï¼Œé€™ç¾¤å‹•ç‰©æ˜¯æˆ‘çš„è‡£æ°‘ã€‚ã€ä¿®è¾­æ˜¯ï¼Ÿ", options: ["è­¬å–»", "èª‡é£¾", "è½‰åŒ–", "æ˜ è¥¯"], ans: 1, explanation: "éš±å–»ï¼ˆæš—å–»ï¼‰ã€‚" },
            { id: 42, unit: "ç¬¬åäºŒèª²", type: "æˆèª", q: "ã€Œå‚é ­å–ªæ°£ã€ç›¸åè©ï¼Ÿ", options: ["è¶¾é«˜æ°£æš", "ç„¡ç²¾æ‰“é‡‡", "ç°å¿ƒå–ªå¿—", "ä¸€è¹¶ä¸æŒ¯"], ans: 1, explanation: "å‚é ­å–ªæ°£ç‚ºå¤±æ„ï¼Œè¶¾é«˜æ°£æšç‚ºå¾—æ„ã€‚" },

            // ç¶œåˆè¤‡ç¿’é¡Œ
            { id: 43, unit: "ç¶œåˆ", type: "éƒ¨é¦–", q: "ã€Œå•Ÿã€ç™¼çš„å•Ÿæ˜¯ä»€éº¼éƒ¨é¦–ï¼Ÿ", options: ["å£", "æ”´", "åˆ", "æˆ·"], ans: 1, explanation: "å£éƒ¨ã€‚" },
            { id: 44, unit: "ç¶œåˆ", type: "æ¨™é»", q: "ã€Œé€™ä¸€åº§æ£®æ—çœŸç¾â–¡å……æ»¿äº†ç”Ÿæ©Ÿã€‚ã€", options: ["ï¼Œ", "ï¼", "ï¼Ÿ", "ï¼š"], ans: 2, explanation: "æ„Ÿå˜†å¥ç”¨é©šå˜†è™Ÿã€‚" },
            { id: 45, unit: "ç¶œåˆ", type: "å­—éŸ³", q: "æ•™ã€Œèª¨ã€çš„è®€éŸ³ï¼Ÿ", options: ["ã„ã„¨ã„ŸË‡", "ã„ã„¨ã„ŸË‹", "ã„ã„¨ã„Ÿ", "ã„‡ã„ŸË‡"], ans: 2, explanation: "æ•™èª¨ï¼šã„ã„¨ã„ŸË‹ã€‚" },
            { id: 46, unit: "ç¶œåˆ", type: "è©èª", q: "ã€Œæ ©æ ©å¦‚ç”Ÿã€å½¢å®¹ï¼Ÿ", options: ["æ­»æ°£æ²‰æ²‰", "éå¸¸ç”Ÿå‹•é€¼çœŸ", "å¾ˆå®‰éœ", "å¾ˆåµé¬§"], ans: 2, explanation: "å½¢å®¹è²Œæ…‹é€¼çœŸï¼Œåƒæ´»çš„ä¸€æ¨£ã€‚" },
            { id: 47, unit: "ç¶œåˆ", type: "æ”¹éŒ¯å­—", q: "ã€Œé€™æ˜¯ä¸€å€‹åƒè¼‰é›£é€¢çš„æ©Ÿé‡ã€‚ã€æ˜¯å¦æœ‰éŒ¯å­—ï¼Ÿ", options: ["è¼‰æ‡‰ç‚ºè¼‰", "é€¢æ‡‰ç‚ºè“¬", "é‡æ‡‰ç‚ºè¿‚", "å…¨å°"], ans: 4, explanation: "å®Œå…¨æ­£ç¢ºã€‚" },
            { id: 48, unit: "ç¶œåˆ", type: "å­—éŸ³", q: "ã€Œæ•¸ã€è½çš„è®€éŸ³ï¼Ÿ", options: ["ã„•ã„¨Ë‹", "ã„•ã„¨Ë‡", "ã„•ã„¨ã„›Ë‹", "ã„™ã„¨Ë‹"], ans: 2, explanation: "æ•¸è½ï¼šã„•ã„¨Ë‡ã€‚" },
            { id: 49, unit: "ç¶œåˆ", type: "æˆèª", q: "ã€Œè‡ªæš´è‡ªæ£„ã€çš„æ„æ€ï¼Ÿ", options: ["è‡ªæˆ‘åçœ", "è‡ªå·±ç³Ÿè¹‹è‡ªå·±ï¼Œä¸æ±‚ä¸Šé€²", "éå¸¸æœ‰è‡ªä¿¡", "è„¾æ°£å¾ˆæš´èº"], ans: 2, explanation: "è‡ªå·±ç§ä¸èµ·è‡ªå·±ï¼Œç”˜æ–¼å¢®è½ã€‚" },
            { id: 50, unit: "ç¶œåˆ", type: "é‚è¼¯", q: "å“ªä¸€èª²å‘Šè¨´æˆ‘å€‘è¦ã€Œæ„›è­·å‹•ç‰©ã€ï¼Ÿ", options: ["ç‚ºç”Ÿå‘½æ‰¾å‡ºå£", "å±±ä¸­å¯„æƒ…", "èˆ‡é”é§­é»‘ç†Šèµ°å…¥å±±æ—", "è’å³¶ä¸Šçš„åœ‹ç‹"], ans: 3, explanation: "ç¬¬åä¸€èª²ã€‚" }
        ];

        // --- è®Šæ•¸å®£å‘Š ---
        let questions = [...defaultQuestions];
        let currentQuestions = [];
        let userAnswers = {}; // ç´€éŒ„ç­”æ¡ˆ { id: é¸é …ç´¢å¼• }
        let markedQuestions = new Set(); // ç¨å¾Œä½œç­”ç´€éŒ„
        let timerInterval;
        let timeRemaining = 2400; // 40åˆ†é˜ = 2400ç§’

        // --- å…¨åŸŸåŠŸèƒ½å‡½æ•¸ ---

        // 1. æ´—ç‰Œç®—æ³• (éš¨æ©Ÿå‡ºé¡Œ)
        window.shuffle = function(array) {
            let currentIndex = array.length, randomIndex;
            while (currentIndex != 0) {
                randomIndex = Math.floor(Math.random() * currentIndex);
                currentIndex--;
                [array[currentIndex], array[randomIndex]] = [array[randomIndex], array[currentIndex]];
            }
            return array;
        }

        // 2. é–‹å§‹æ¸¬é©—
        window.startExam = function() {
            // åˆå§‹åŒ–
            currentQuestions = window.shuffle([...questions]);
            userAnswers = {};
            markedQuestions.clear();
            timeRemaining = 2400;

            // æ¸²æŸ“ç•«é¢
            window.renderQuestions();
            window.updateStats();

            // åˆ‡æ›ç•«é¢
            document.getElementById('startScreen').classList.add('hidden');
            document.getElementById('examScreen').classList.remove('hidden');
            document.getElementById('statsFooter').classList.remove('hidden');
            document.getElementById('timerDisplay').classList.remove('hidden');

            // å•Ÿå‹•è¨ˆæ™‚
            window.startTimer();
            
            // æ²å‹•åˆ°é ‚éƒ¨
            window.scrollTo(0, 0);
        }

        // 3. è¨ˆæ™‚å™¨é‚è¼¯
        window.startTimer = function() {
            window.updateTimerDisplay();
            timerInterval = setInterval(() => {
                timeRemaining--;
                window.updateTimerDisplay();

                // æ™‚é–“æé†’
                if (timeRemaining === 1500) window.showToast("ğŸ”” æé†’ï¼šå‰©é¤˜ 25 åˆ†é˜");
                if (timeRemaining === 600) window.showToast("âš ï¸ æ³¨æ„ï¼šå‰©é¤˜ 10 åˆ†é˜", "warning");
                if (timeRemaining === 300) window.showToast("ğŸ”¥ è­¦å‘Šï¼šå‰©é¤˜ 5 åˆ†é˜ï¼", "error");
                
                if (timeRemaining <= 0) {
                    clearInterval(timerInterval);
                    Swal.fire({
                        title: "æ™‚é–“åˆ°ï¼",
                        text: "ç³»çµ±å°‡è‡ªå‹•ç¹³å·",
                        icon: "info",
                        timer: 2000,
                        showConfirmButton: false
                    }).then(() => {
                        window.submitExam(true);
                    });
                }
            }, 1000);
        }

        window.updateTimerDisplay = function() {
            const m = Math.floor(timeRemaining / 60);
            const s = timeRemaining % 60;
            const text = `${m.toString().padStart(2, '0')}:${s.toString().padStart(2, '0')}`;
            const el = document.getElementById('timerDisplay');
            el.innerText = text;
            
            if (timeRemaining < 300) { // æœ€å¾Œ5åˆ†é˜è®Šç´…
                el.classList.remove('text-[#4B9DA9]');
                el.classList.add('text-red-600', 'animate-pulse');
            }
        }

        window.showToast = function(title, icon = 'info') {
            Swal.fire({
                toast: true,
                position: 'top-end',
                icon: icon,
                title: title,
                showConfirmButton: false,
                timer: 3000
            });
        }

        // 4. æ¸²æŸ“é¡Œç›®
        window.renderQuestions = function() {
            const container = document.getElementById('questionsContainer');
            container.innerHTML = '';

            currentQuestions.forEach((q, index) => {
                const card = document.createElement('div');
                card.id = `q-${q.id}`;
                card.className = "bg-white p-6 rounded-2xl shadow-md border-l-8 border-[#4B9DA9] question-card";
                
                let html = `
                    <div class="flex justify-between items-start mb-4">
                        <div class="flex items-center gap-2 flex-wrap">
                            <span class="bg-[#4B9DA9] text-white px-3 py-1 rounded-full font-bold text-lg">Q${index + 1}</span>
                            <span class="text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded border">${q.unit}</span>
                            <span class="text-xs text-[#E37434] border border-[#E37434] px-2 py-1 rounded">${q.type}</span>
                        </div>
                        <label class="flex items-center space-x-2 cursor-pointer select-none bg-yellow-50 px-3 py-1 rounded-full border border-yellow-200 hover:bg-yellow-100">
                            <input type="checkbox" onchange="window.toggleMark(${q.id})" class="form-checkbox text-yellow-500 h-5 w-5">
                            <span class="text-sm font-bold text-gray-600">ç¨å¾Œä½œç­”</span>
                        </label>
                    </div>
                    
                    <p class="text-xl font-bold text-gray-800 mb-6 leading-relaxed border-b pb-4">${q.q}</p>
                    
                    <div class="grid gap-3">
                `;

                q.options.forEach((opt, optIndex) => {
                    const val = optIndex + 1;
                    html += `
                        <label class="flex items-center p-4 rounded-xl border-2 border-transparent bg-gray-50 hover:bg-[#F6F3C2] hover:border-[#91C6BC] cursor-pointer transition-all" id="opt-${q.id}-${val}">
                            <input type="radio" name="q_${q.id}" value="${val}" onchange="window.selectAnswer(${q.id}, ${val})" class="w-6 h-6 text-[#4B9DA9] focus:ring-[#4B9DA9]">
                            <span class="ml-3 text-lg text-gray-700 font-medium">(${val}) ${opt}</span>
                        </label>
                    `;
                });

                // è§£æå€å¡Š (é è¨­éš±è—)
                html += `
                    </div>
                    <div id="explain-${q.id}" class="hidden mt-6 bg-orange-50 p-4 rounded-xl border border-orange-200 text-left animate-fade-in">
                        <p class="font-bold text-[#E37434] mb-1 flex items-center">ğŸ’¡ è§£æï¼š</p>
                        <p class="text-gray-700">${q.explanation}</p>
                    </div>
                `;

                card.innerHTML = html;
                container.appendChild(card);
            });
        }

        // 5. ä½¿ç”¨è€…äº’å‹•
        window.selectAnswer = function(qId, val) {
            userAnswers[qId] = val;
            const card = document.getElementById(`q-${qId}`);
            if (card) card.classList.remove('unanswered-highlight');
            window.updateStats();
        }

        window.toggleMark = function(qId) {
            if (markedQuestions.has(qId)) markedQuestions.delete(qId);
            else markedQuestions.add(qId);
            window.updateStats();
        }

        window.updateStats = function() {
            const total = currentQuestions.length;
            const answered = Object.keys(userAnswers).length;
            const unanswered = total - answered;
            const marked = markedQuestions.size;

            document.getElementById('answeredCount').innerText = answered;
            document.getElementById('unansweredCount').innerText = unanswered;
            document.getElementById('markCount').innerText = marked;
        }

        // 6. ç¹³å·æª¢æŸ¥
        window.attemptSubmit = async function() {
            // æª¢æŸ¥æœªç­”
            const unansweredIds = currentQuestions.filter(q => !userAnswers[q.id]).map(q => q.id);
            
            if (unansweredIds.length > 0) {
                // è‡ªå‹•è·³è½‰åˆ°ç¬¬ä¸€é¡Œæœªç­”
                Swal.fire({
                    icon: 'warning',
                    title: 'é‚„æœ‰é¡Œç›®æ²’å¯«å–”ï¼',
                    text: `æ‚¨é‚„æœ‰ ${unansweredIds.length} é¡Œæœªä½œç­”ã€‚`,
                    confirmButtonText: 'å»è£œå¯«',
                    confirmButtonColor: '#E37434'
                }).then(() => {
                    const targetId = `q-${unansweredIds[0]}`;
                    const el = document.getElementById(targetId);
                    el.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    el.classList.add('unanswered-highlight');
                    setTimeout(() => el.classList.remove('unanswered-highlight'), 2000);
                });
                return;
            }

            // æª¢æŸ¥æ¨™è¨˜
            if (markedQuestions.size > 0) {
                const confirm = await Swal.fire({
                    icon: 'question',
                    title: 'é‚„æœ‰ã€Œç¨å¾Œä½œç­”ã€çš„è¨˜è™Ÿ',
                    text: `æœ‰ ${markedQuestions.size} é¡Œé‚„ç•™è‘—è¨˜è™Ÿï¼Œç¢ºå®šè¦äº¤å·å—ï¼Ÿ`,
                    showCancelButton: true,
                    confirmButtonText: 'ç¢ºå®šç¹³å·',
                    cancelButtonText: 'å†æª¢æŸ¥ä¸€ä¸‹',
                    confirmButtonColor: '#4B9DA9'
                });
                if (!confirm.isConfirmed) return;
            }

            // ç›´æ¥ç¹³å·
            window.submitExam(false);
        }

        // 7. åŸ·è¡Œç¹³å·èˆ‡è©•åˆ†
        window.submitExam = function(auto) {
            clearInterval(timerInterval);
            
            let score = 0;
            let wrongList = [];
            const scorePerQ = 100 / currentQuestions.length;

            currentQuestions.forEach(q => {
                const userAns = userAnswers[q.id];
                const isCorrect = userAns === q.ans;
                
                if (isCorrect) score += scorePerQ;
                else wrongList.push({ ...q, userAns });

                // é¡¯ç¤ºè©³è§£èˆ‡å°éŒ¯
                const card = document.getElementById(`q-${q.id}`);
                document.getElementById(`explain-${q.id}`).classList.remove('hidden');
                
                // é–å®šé¸é …
                card.querySelectorAll('input').forEach(i => i.disabled = true);

                // æ¨™ç¤ºé¡è‰²
                const correctLabel = card.querySelector(`#opt-${q.id}-${q.ans}`);
                if (correctLabel) {
                    correctLabel.classList.add('correct-ans');
                    correctLabel.innerHTML += ` âœ…`;
                }

                if (!isCorrect && userAns) {
                    const wrongLabel = card.querySelector(`#opt-${q.id}-${userAns}`);
                    if (wrongLabel) {
                        wrongLabel.classList.add('wrong-ans');
                        wrongLabel.innerHTML += ` âŒ`;
                    }
                }
            });

            score = Math.round(score);

            // éš±è—åº•éƒ¨çµ±è¨ˆèˆ‡ç¹³å·æŒ‰éˆ• (ç¢ºä¿ç„¡æ³•é‡è¤‡æäº¤)
            document.getElementById('statsFooter').classList.add('hidden');

            // é¡¯ç¤ºæˆç¸¾å–®
            Swal.fire({
                title: 'æ¸¬é©—çµæŸï¼',
                html: `
                    <div class="text-6xl font-bold ${score >= 60 ? 'text-green-500' : 'text-red-500'} mb-4">${score} åˆ†</div>
                    <p class="text-gray-600">ç­”éŒ¯ï¼š${wrongList.length} é¡Œ</p>
                    <p class="text-sm text-gray-400 mt-2">ç³»çµ±å·²è‡ªå‹•ä¸‹è¼‰ Excel è¨‚æ­£è¡¨</p>
                `,
                icon: score >= 90 ? 'success' : 'info',
                confirmButtonText: 'æŸ¥çœ‹éŒ¯é¡Œè©³è§£',
                confirmButtonColor: '#4B9DA9'
            });

            // åŒ¯å‡º Excel
            if (wrongList.length > 0) {
                window.exportToExcel(wrongList, score);
            }
        }

        // 8. Excel åŒ¯å‡ºåŠŸèƒ½
        window.exportToExcel = function(wrongList, score) {
            const data = [
                ["113å­¸å¹´-åº·è»’(äº”ä¸Š)åœ‹èªç·šä¸ŠæœŸæœ«æ¸¬é©—ç³»çµ± - éŒ¯é¡Œè¨‚æ­£è¡¨"],
                [`å¾—åˆ†ï¼š${score} åˆ†`, `æ—¥æœŸï¼š${new Date().toLocaleDateString()}`],
                [],
                ["é¡Œè™Ÿ", "å–®å…ƒ", "é¡Œç›®", "æ­£ç¢ºç­”æ¡ˆ", "æ‚¨çš„ç­”æ¡ˆ", "è§£æ"]
            ];

            wrongList.forEach(item => {
                const correctText = item.options[item.ans - 1];
                const userText = item.userAns ? item.options[item.userAns - 1] : "æœªä½œç­”";
                data.push([item.id, item.unit, item.q, correctText, userText, item.explanation]);
            });

            const wb = XLSX.utils.book_new();
            const ws = XLSX.utils.aoa_to_sheet(data);

            // è¨­å®šç´…å­—åŠ ç²—æ¨£å¼
            const range = XLSX.utils.decode_range(ws['!ref']);
            for (let R = 4; R <= range.e.r; ++R) {
                const cellRef = XLSX.utils.encode_cell({r: R, c: 4});
                if (ws[cellRef]) {
                    ws[cellRef].s = {
                        font: { bold: true, color: { rgb: "FF0000" } },
                        fill: { fgColor: { rgb: "FEE2E2" } }
                    };
                }
            }

            // èª¿æ•´æ¬„å¯¬
            ws['!cols'] = [{wch:5}, {wch:10}, {wch:40}, {wch:20}, {wch:20}, {wch:40}];

            XLSX.utils.book_append_sheet(wb, ws, "éŒ¯é¡Œåˆ†æ");
            XLSX.writeFile(wb, "exam_result.xlsx");
        }

        // 9. è€å¸«å°ˆå€åŠŸèƒ½
        window.toggleTeacherZone = async function() {
            const el = document.getElementById('teacherZone');
            if (el.classList.contains('hidden')) {
                const { value: pass } = await Swal.fire({
                    title: 'è¼¸å…¥è€å¸«å¯†ç¢¼',
                    input: 'password',
                    inputPlaceholder: 'å¯†ç¢¼ï¼š1234',
                    confirmButtonColor: '#4B9DA9'
                });
                if (pass === '1234') {
                    el.classList.remove('hidden');
                } else if(pass) {
                    Swal.fire('å¯†ç¢¼éŒ¯èª¤', 'ç„¡æ³•é€²å…¥è¨­å®šå€', 'error');
                }
            } else {
                el.classList.add('hidden');
            }
        }

        window.downloadQuestions = function() {
            const dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(questions, null, 2));
            const a = document.createElement('a');
            a.href = dataStr;
            a.download = "questions_data.json";
            document.body.appendChild(a);
            a.click();
            a.remove();
        }

        window.uploadQuestions = function(input) {
            const file = input.files[0];
            if (!file) return;
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const json = JSON.parse(e.target.result);
                    if (Array.isArray(json) && json.length > 0) {
                        questions = json;
                        Swal.fire('æˆåŠŸ', `å·²æ›´æ–° ${questions.length} é¡Œè€ƒé¡Œï¼`, 'success');
                    } else {
                        throw new Error();
                    }
                } catch (err) {
                    Swal.fire('éŒ¯èª¤', 'æª”æ¡ˆæ ¼å¼ä¸æ­£ç¢º (éœ€ç‚º JSON)', 'error');
                }
            };
            reader.readAsText(file);
        }

        console.log("System Ready. Version 1.12.16.25");
    </script>
</body>
</html>
