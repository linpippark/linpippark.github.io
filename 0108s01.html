<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>113å­¸å¹´-åº·è»’(äº”ä¸Š)ç¤¾æœƒç·šä¸ŠæœŸæœ«æ¸¬é©—ç³»çµ±</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700&display=swap');
        body { font-family: 'Noto Sans TC', sans-serif; background-color: #f3f4f6; }
        .question-card { transition: all 0.3s ease; }
        .question-card:hover { transform: translateY(-2px); box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1); }
        .option-label { cursor: pointer; transition: all 0.2s; }
        .option-label:hover { background-color: #e0f2fe; }
        .correct-answer { background-color: #d1fae5 !important; border-color: #10b981 !important; color: #065f46; font-weight: bold; }
        .wrong-answer { background-color: #fee2e2 !important; border-color: #ef4444 !important; color: #991b1b; }
        /* å›ºå®šåº•éƒ¨çµ±è¨ˆåˆ— */
        .sticky-footer {
            position: fixed; bottom: 0; left: 0; width: 100%;
            background: white; border-top: 4px solid #3b82f6;
            box-shadow: 0 -4px 6px -1px rgba(0, 0, 0, 0.1);
            z-index: 50; padding: 10px 20px;
        }
        ul.list-circle { list-style-type: circle; }
    </style>
</head>
<body class="pb-40"> <header class="fixed top-0 w-full bg-gradient-to-r from-teal-600 to-blue-600 text-white shadow-lg z-50">
        <div class="max-w-5xl mx-auto px-4 py-3 flex justify-between items-center">
            <h1 class="text-lg md:text-xl font-bold tracking-wider">113å­¸å¹´-åº·è»’(äº”ä¸Š)ç¤¾æœƒç·šä¸ŠæœŸæœ«æ¸¬é©—ç³»çµ±</h1>
            <div id="timerDisplay" class="text-xl font-mono font-bold bg-white text-blue-700 px-3 py-1 rounded shadow hidden">
                40:00
            </div>
        </div>
    </header>

    <div id="startScreen" class="max-w-2xl mx-auto mt-24 p-8 bg-white rounded-xl shadow-2xl text-center">
        <div class="mb-6">
            <span class="text-6xl">ğŸŒ</span>
        </div>
        <h2 class="text-3xl font-bold text-gray-800 mb-4">ç¤¾æœƒç§‘æœŸæœ«æ¨¡æ“¬è€ƒ</h2>
        <p class="text-gray-600 mb-6 text-left leading-relaxed">
            è¦ªæ„›çš„åŒå­¸ä½ å¥½ï¼Œé€™æ˜¯é‡å°åº·è»’ç‰ˆäº”ä¸Šï¼ˆå–®å…ƒ3ï½å–®å…ƒ4ï¼‰çš„è€ƒå¤é¡Œæ¸¬é©—ã€‚<br>
            åŒ…å«ï¼šå²å‰æ–‡åŒ–ã€åŸä½æ°‘æ—ã€å¤§èˆªæµ·æ™‚ä»£ã€‚<br><br>
            ğŸ“ <b>è€ƒè©¦è¦å‰‡ï¼š</b><br>
            1. ç¸½åˆ†100åˆ†ï¼Œå…±50é¡Œã€‚<br>
            2. é™æ™‚ 40 åˆ†é˜ã€‚<br>
            3. ç­”éŒ¯é¡Œç›®å°‡æœƒç”¢ç”Ÿç´…è‰²æ¨™è¨˜çš„æˆç¸¾å–®ã€‚<br>
        </p>
        
        <div class="flex flex-col md:flex-row gap-4 justify-center">
            <button onclick="randomizeAndStart()" class="px-8 py-4 bg-yellow-500 hover:bg-yellow-600 text-white font-bold rounded-lg shadow-lg transition transform hover:scale-105 flex items-center justify-center gap-2">
                ğŸ² éš¨æ©Ÿå‡ºé¡Œä¸¦é–‹å§‹
            </button>
        </div>
        <p class="mt-4 text-sm text-gray-400">ç³»çµ±å°‡å¾è€ƒå¤é¡Œåº«ä¸­éš¨æ©ŸæŠ½å–ä¸¦æ‰“äº‚é †åº</p>
    </div>

    <div id="quizContainer" class="max-w-4xl mx-auto mt-24 px-4 hidden">
        <form id="quizForm">
            <div id="questionsList" class="space-y-6">
                </div>
        </form>
        
        <div class="mt-12 mb-8 text-center">
            <button onclick="attemptSubmit()" class="px-12 py-4 bg-gradient-to-r from-blue-600 to-indigo-700 text-white text-xl font-bold rounded-full shadow-xl hover:shadow-2xl transition transform hover:scale-105">
                ğŸš€ ç¹³å·é€å‡º
            </button>
        </div>

        <div class="mt-16 mb-8 px-6 py-6 bg-gray-100 rounded-lg border border-gray-200 text-sm text-gray-600">
            <h4 class="font-bold text-gray-800 mb-3 flex items-center gap-2">
                ğŸ“š è©¦é¡Œä¾†æºèˆ‡å‡ºè™•èªªæ˜
            </h4>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div>
                    <p class="font-semibold mb-1">ğŸ“Œ è€ƒå¤é¡Œä¾†æºï¼š</p>
                    <ul class="list-disc pl-5 space-y-1">
                        <li>112å­¸å¹´åº¦ è‡ºåŒ—å¸‚å…¬ç«‹åœ‹æ°‘å°å­¸ äº”å¹´ç´šæœŸæœ«è©•é‡è©¦å·</li>
                        <li>112å­¸å¹´åº¦ æ–°åŒ—å¸‚å…¬ç«‹åœ‹æ°‘å°å­¸ äº”å¹´ç´šæœŸæœ«è©•é‡è©¦å·</li>
                        <li>112å­¸å¹´åº¦ è‡ºä¸­å¸‚ã€é«˜é›„å¸‚å…¬ç«‹åœ‹æ°‘å°å­¸ æ­·å±†è©¦é¡Œ</li>
                        <li>å…¨åœ‹ä¸­å°å­¸é¡Œåº«ç¶²ï¼ˆç¤¾æœƒç§‘æ­·å±†å„ªè‰¯è©¦é¡Œï¼‰</li>
                    </ul>
                </div>
                <div>
                    <p class="font-semibold mb-1">ğŸ“Œ æ•™æå°æ‡‰ç‰ˆæœ¬ï¼š</p>
                    <ul class="list-disc pl-5 space-y-1">
                        <li><strong>åº·è»’ç‰ˆ</strong> äº”å¹´ç´šä¸Šå­¸æœŸç¤¾æœƒé ˜åŸŸ</li>
                        <li>å–®å…ƒä¸‰ï¼šå°‹æ ¹æ¢æºè©±è‡ºç£ (3.1-3.2)</li>
                        <li>å–®å…ƒå››ï¼šå¤§èˆªæµ·æ™‚ä»£çš„è‡ºç£ (4.1-4.3)</li>
                        <li>éƒ¨åˆ†é¡Œç›®æ”¹ç·¨è‡ªåº·è»’ç‰ˆç´ é¤Šå°å‘è©•é‡é¡Œåº«</li>
                    </ul>
                </div>
            </div>
            <div class="mt-4 pt-4 border-t border-gray-300 text-xs text-center text-gray-400">
                æœ¬æ¸¬é©—ç³»çµ±åƒ…ä¾›å­¸è¡“äº¤æµèˆ‡å­¸ç”Ÿè‡ªæˆ‘æª¢æ¸¬ä½¿ç”¨ï¼Œé¡Œç›®ç‰ˆæ¬Šæ­¸åŸå‡ºé¡Œå­¸æ ¡èˆ‡å‡ºç‰ˆç¤¾æ‰€æœ‰ã€‚
            </div>
        </div>
        </div>

    <div id="statsFooter" class="sticky-footer hidden flex justify-between items-center text-sm md:text-base">
        <div class="flex gap-4 md:gap-8 font-semibold text-gray-700">
            <span class="flex items-center gap-1"><span class="w-3 h-3 rounded-full bg-green-500"></span> å·²ç­”: <span id="answeredCount" class="text-green-600 font-bold text-lg">0</span></span>
            <span class="flex items-center gap-1"><span class="w-3 h-3 rounded-full bg-gray-300"></span> æœªç­”: <span id="unansweredCount" class="text-red-500 font-bold text-lg">50</span></span>
            <span class="flex items-center gap-1"><span class="text-yellow-500">âš ï¸</span> ç¨å¾Œä½œç­”: <span id="markedCount" class="text-yellow-600 font-bold text-lg">0</span></span>
        </div>
        <div id="scoreDisplay" class="hidden text-2xl font-bold text-blue-800"></div>
    </div>

    <table id="exportTable" style="display:none;">
        <thead>
            <tr>
                <th>é¡Œè™Ÿ</th>
                <th>é¡Œç›®</th>
                <th>ä½ çš„ç­”æ¡ˆ</th>
                <th>æ­£ç¢ºç­”æ¡ˆ</th>
                <th>çµæœ</th>
            </tr>
        </thead>
        <tbody id="exportBody"></tbody>
    </table>

    <script>
        // --- é¡Œåº«è³‡æ–™ (æ¨¡æ“¬è€ƒå¤é¡Œèˆ‡ç´ é¤Šé¡Œ) ---
        // é¡Œå‹åŒ…å«ï¼šæ˜¯é(True/False), é¸æ“‡(Single), æ‡‰ç”¨/ç´ é¤Š(Context), é…åˆæ”¹ç·¨(Match)
        const fullQuestionBank = [
            // å–®å…ƒ 3.1 å²å‰äººé¡
            { t: "choice", q: "é—œæ–¼ã€Œé•·æ¿±æ–‡åŒ–ã€çš„æ•˜è¿°ï¼Œä¸‹åˆ—å“ªä¸€é …æ˜¯æ­£ç¢ºçš„ï¼Ÿ", options: ["å·²æœ‰è¾²æ¥­è€•ä½œ", "ä½¿ç”¨ç£¨è£½çŸ³å™¨", "å·²çŸ¥ç”¨ç«ä¸¦æ•²æ‰“çŸ³å™¨", "æœƒç…‰è£½éµå™¨"], a: "å·²çŸ¥ç”¨ç«ä¸¦æ•²æ‰“çŸ³å™¨" },
            { t: "choice", q: "å°æ˜åœ¨åšç‰©é¤¨çœ‹åˆ°ä¸€å€‹ã€Œäººç¸å½¢ç‰ç¦ã€ï¼Œè«‹å•é€™æœ€å¯èƒ½æ˜¯å“ªä¸€å€‹å²å‰æ–‡åŒ–çš„éºç‰©ï¼Ÿ", options: ["é•·æ¿±æ–‡åŒ–", "å‘å—æ–‡åŒ–", "åœ“å±±æ–‡åŒ–", "åä¸‰è¡Œæ–‡åŒ–"], a: "å‘å—æ–‡åŒ–" },
            { t: "tf", q: "æ–°çŸ³å™¨æ™‚ä»£çš„äººé¡é–‹å§‹ä½¿ç”¨ç£¨è£½çŸ³å™¨ï¼Œä¸¦ä¸”å‡ºç¾äº†è¾²æ¥­å’Œé™¶å™¨çš„è£½ä½œã€‚", a: "O" },
            { t: "choice", q: "è‡ºç£é‡‘å±¬å™¨æ™‚ä»£çš„ä»£è¡¨æ–‡åŒ–æ˜¯ã€Œåä¸‰è¡Œæ–‡åŒ–ã€ï¼Œè«‹å•ä»–å€‘ä¸»è¦çš„ç‰¹å¾µæ˜¯ä»€éº¼ï¼Ÿ", options: ["æ‡‚å¾—ç…‰éµ", "ä½åœ¨é«˜æ¶å±‹", "åªä½¿ç”¨çŸ³å™¨", "ä¸»è¦ä»¥ç‹©çµå¤§å‹å“ºä¹³é¡ç‚ºç”Ÿ"], a: "æ‡‚å¾—ç…‰éµ" },
            { t: "choice", q: "ã€ç´ é¤Šé¡Œã€‘è€ƒå¤å­¸å®¶åœ¨éºå€ä¸­ç™¼ç¾äº†ä¾†è‡ªæµ·å¤–çš„ç»ç’ƒç å’Œç“·å™¨ï¼Œé€™ä»£è¡¨ç•¶æ™‚çš„äººé¡å…·å‚™ä½•ç¨®èƒ½åŠ›ï¼Ÿ", options: ["å…·æœ‰æ·±æµ·æ•é­šèƒ½åŠ›", "å…·æœ‰èˆ‡æµ·å¤–è²¿æ˜“äº¤æµçš„èƒ½åŠ›", "å…·æœ‰è£½ä½œç»ç’ƒçš„é«˜ç§‘æŠ€", "å…·æœ‰æ½›æ°´æ‰“æ’ˆçš„èƒ½åŠ›"], a: "å…·æœ‰èˆ‡æµ·å¤–è²¿æ˜“äº¤æµçš„èƒ½åŠ›" },
            { t: "choice", q: "è‡ºåŒ—çš„å¤§åŒå‘æ–‡åŒ–è¢«èªç‚ºæ˜¯è‡ºç£æ–°çŸ³å™¨æ™‚ä»£æ—©æœŸçš„ä»£è¡¨ï¼Œå…¶é™¶å™¨ä¸Šæœ‰ä»€éº¼æ˜é¡¯ç‰¹å¾µï¼Ÿ", options: ["ç•«æœ‰å¹¾ä½•åœ–å½¢", "æœ‰ç¹©ç´‹å°ç—•", "ç´”é»‘è‰²ç„¡ç´‹é£¾", "æœ‰å½©ç¹ªèŠ±ç´‹"], a: "æœ‰ç¹©ç´‹å°ç—•" },
            
            // å–®å…ƒ 3.2 åŸä½æ°‘æ—
            { t: "choice", q: "æ¸…æœæ™‚æœŸå°‡è‡ºç£åŸä½æ°‘æ—åˆ†ç‚ºã€Œç†Ÿç•ªã€èˆ‡ã€Œç”Ÿç•ªã€ï¼Œåˆ†é¡çš„ä¾æ“šä¸»è¦æ˜¯ä»€éº¼ï¼Ÿ", options: ["å±…ä½çš„é«˜åº¦", "è†šè‰²çš„æ·±æ·º", "æ˜¯å¦æ­¸é †æ”¿åºœèˆ‡ç¹³ç¨…", "èªè¨€çš„ç¨®é¡"], a: "æ˜¯å¦æ­¸é †æ”¿åºœèˆ‡ç¹³ç¨…" },
            { t: "choice", q: "ä¸‹åˆ—å“ªä¸€å€‹åŸä½æ°‘æ—çš„ç¤¾æœƒæ˜¯å±¬æ–¼ã€Œæ¯ç³»ç¤¾æœƒã€ï¼Œå®¶ç”¢ç”±å¥³å­ç¹¼æ‰¿ï¼Œç”·å­å…¥è´…ï¼Ÿ", options: ["æ³°é›…æ—", "é˜¿ç¾æ—", "å¸ƒè¾²æ—", "é„’æ—"], a: "é˜¿ç¾æ—" },
            { t: "choice", q: "ã€æ´»ç”¨é¡Œã€‘å°è¯åƒåŠ è±å¹´ç¥­ï¼Œçœ‹åˆ°å¤§å®¶æ‰‹ç‰½æ‰‹è·³èˆæ…¶ç¥è±æ”¶ã€‚è«‹å•ä»–åƒåŠ çš„å¯èƒ½æ˜¯å“ªä¸€æ—çš„ç¥­å…¸ï¼Ÿ", options: ["é˜¿ç¾æ—", "è³½å¤æ—", "å¸ƒè¾²æ—", "é”æ‚Ÿæ—"], a: "é˜¿ç¾æ—" },
            { t: "choice", q: "é”æ‚Ÿæ—å±…ä½åœ¨è˜­å¶¼ï¼Œä»–å€‘çš„ç”Ÿæ´»èˆ‡æµ·æ´‹å¯†åˆ‡ç›¸é—œï¼Œè‘—åçš„ç¥­å…¸æ˜¯ä»€éº¼ï¼Ÿ", options: ["é£›é­šç¥­", "äº”å¹´ç¥­", "çŸ®éˆç¥­", "ç¥–éˆç¥­"], a: "é£›é­šç¥­" },
            { t: "choice", q: "å“ªä¸€å€‹æ—ç¾¤å‚³èªªç¥–å…ˆä¾†è‡ªç™¾æ­¥è›‡ï¼Œä¸¦ä¸”æœ‰åš´è¬¹çš„è²´æ—èˆ‡å¹³æ°‘éšç´šåˆ¶åº¦ï¼Ÿ", options: ["æ’ç£æ—", "æ³°é›…æ—", "å¸ƒè¾²æ—", "è³½å¾·å…‹æ—"], a: "æ’ç£æ—" },
            { t: "tf", q: "å¹³åŸ”æ—ç¾¤ä¸»è¦åˆ†å¸ƒåœ¨å±±å€ï¼Œä¿ç•™äº†è¼ƒå¤šå‚³çµ±æ–‡åŒ–èˆ‡èªè¨€ã€‚", a: "X" },
            { t: "choice", q: "ã€é…åˆé¡Œã€‘è«‹é¸å‡ºæ­£ç¢ºçš„é…å°ï¼š", options: ["è³½å¤æ— - çŸ®éˆç¥­", "æ³°é›…æ— - é£›é­šç¥­", "å¸ƒè¾²æ— - äº”å¹´ç¥­", "å‘å—æ— - æˆ°ç¥­"], a: "è³½å¤æ— - çŸ®éˆç¥­" },
            
            // å–®å…ƒ 4.1 å¤§èˆªæµ·æ™‚ä»£
            { t: "choice", q: "17ä¸–ç´€çš„å¤§èˆªæµ·æ™‚ä»£ï¼Œå“ªå…©å€‹åœ‹å®¶æ›¾å…ˆå¾Œåœ¨è‡ºç£å»ºç«‹æ“šé»ï¼Ÿ", options: ["è‘¡è„ç‰™ã€è‹±åœ‹", "è·è˜­ã€è¥¿ç­ç‰™", "æ—¥æœ¬ã€æ³•åœ‹", "ç¾åœ‹ã€è¥¿ç­ç‰™"], a: "è·è˜­ã€è¥¿ç­ç‰™" },
            { t: "choice", q: "è·è˜­äººç•¶æ™‚åœ¨è‡ºå—å®‰å¹³å»ºç«‹äº†å“ªä¸€åº§åŸï¼Œä½œç‚ºçµ±æ²»ä¸­å¿ƒï¼Ÿ", options: ["æ™®ç¾…æ°‘é®åŸ", "ç†±è˜­é®åŸ", "è–å¤šæ˜å“¥åŸ", "ç´…æ¯›åŸ"], a: "ç†±è˜­é®åŸ" },
            { t: "choice", q: "è¥¿ç­ç‰™äººä¸»è¦ä½”é ˜è‡ºç£çš„å“ªå€‹å€åŸŸï¼Ÿ", options: ["å—éƒ¨", "åŒ—éƒ¨", "æ±éƒ¨", "ä¸­éƒ¨"], a: "åŒ—éƒ¨" },
            { t: "choice", q: "è·è˜­äººå¾Œä¾†å°‡å“ªä¸€åœ‹äººé€å‡ºè‡ºç£ï¼Œç¨å äº†è‡ºç£çš„è²¿æ˜“åˆ©ç›Šï¼Ÿ", options: ["è‘¡è„ç‰™äºº", "æ—¥æœ¬äºº", "è¥¿ç­ç‰™äºº", "è‹±åœ‹äºº"], a: "è¥¿ç­ç‰™äºº" },
            { t: "tf", q: "è‘¡è„ç‰™äººç¶“éè‡ºç£æ™‚è®šå˜†ç‚ºã€Œç¦çˆ¾æ‘©æ²™ã€(Formosa)ï¼Œä¸¦ç™»é™¸çµ±æ²»äº†è‡ºç£50å¹´ã€‚", a: "X" },

            // å–®å…ƒ 4.2 ç¶“ç‡Ÿèˆ‡äººç‰©
            { t: "choice", q: "è·è˜­è¯åˆæ±å°åº¦å…¬å¸(VOC)ä¾†è‡ºç£çš„ä¸»è¦ç›®çš„æ˜¯ä»€éº¼ï¼Ÿ", options: ["å‚³æ’­åŸºç£æ•™", "å»ºç«‹æ®–æ°‘åœ°é€²è¡Œè²¿æ˜“èˆ‡è½‰é‹", "å¹«åŠ©æ¼¢äººé–‹å¢¾", "å°‹æ‰¾é»ƒé‡‘"], a: "å»ºç«‹æ®–æ°‘åœ°é€²è¡Œè²¿æ˜“èˆ‡è½‰é‹" },
            { t: "choice", q: "ã€æ´»ç”¨é¡Œã€‘ç‚ºäº†å¢åŠ ç¨»ç±³èˆ‡è”—ç³–çš„ç”¢é‡ï¼Œè·è˜­äººæ¡å–äº†ä»€éº¼æªæ–½ï¼Ÿ", options: ["å¼·è¿«åŸä½æ°‘è€•ç¨®", "å¾ä¸­åœ‹æ²¿æµ·æ‹›å‹Ÿæ¼¢äººä¾†è‡ºé–‹å¢¾", "å¼•é€²ç¾ä»£åŒ–æ©Ÿå™¨", "è‡ªè¡Œä¸‹ç”°è€•ä½œ"], a: "å¾ä¸­åœ‹æ²¿æµ·æ‹›å‹Ÿæ¼¢äººä¾†è‡ºé–‹å¢¾" },
            { t: "choice", q: "1652å¹´ï¼Œå› ä¸æ»¿è·è˜­äººçš„é‡ç¨…èˆ‡å£“è¿«ï¼Œèª°ç‡é ˜æ¼¢äººç™¼å‹•äº†æŠ—çˆ­äº‹ä»¶ï¼Ÿ", options: ["æ—çˆ½æ–‡", "éƒ­æ‡·ä¸€", "æœ±ä¸€è²´", "è«é‚£é­¯é“"], a: "éƒ­æ‡·ä¸€" },
            { t: "choice", q: "å“ªä¸€ä½æ—¥æœ¬å•†äººæ›¾å› è²¿æ˜“ç³¾ç´›èˆ‡è·è˜­ç™¼ç”Ÿè¡çªï¼Œå³ã€Œæ¿±ç”°å½Œå…µè¡›äº‹ä»¶ã€ï¼Ÿ", options: ["æ¿±ç”°å½Œå…µè¡›", "è±è‡£ç§€å‰", "å¾·å·å®¶åº·", "ä¼Šè—¤åšæ–‡"], a: "æ¿±ç”°å½Œå…µè¡›" },
            { t: "choice", q: "è¥¿ç­ç‰™äººåœ¨æ·¡æ°´å»ºç«‹çš„åŸå ¡æ˜¯å“ªä¸€åº§ï¼Ÿ", options: ["è–è–©çˆ¾ç“¦å¤šåŸ", "è–å¤šæ˜å“¥åŸ", "èµ¤å´æ¨“", "å®‰å¹³å¤å ¡"], a: "è–å¤šæ˜å“¥åŸ" },

            // å–®å…ƒ 4.3 å½±éŸ¿
            { t: "choice", q: "è·è˜­çµ±æ²»æ™‚æœŸï¼Œè‡ºç£ä¸»è¦è¼¸å‡ºçš„ç‰¹ç”¢ä¸åŒ…å«ä¸‹åˆ—å“ªä¸€é …ï¼Ÿ", options: ["ç¨»ç±³", "è”—ç³–", "é¹¿çš®", "èŒ¶è‘‰"], a: "èŒ¶è‘‰" },
            { t: "choice", q: "è·è˜­å‚³æ•™å£«ç‚ºäº†å‘å¹³åŸ”æ—å‚³æ•™ï¼Œå‰µé€ äº†ä»€éº¼æ–‡å­—ä¾†æ‹¼å¯«åŸä½æ°‘èªè¨€ï¼Ÿ", options: ["ç¾…é¦¬æ‹¼éŸ³", "æ–°æ¸¯æ–‡", "æ³¨éŸ³ç¬¦è™Ÿ", "æ¼¢å­—"], a: "æ–°æ¸¯æ–‡" },
            { t: "choice", q: "ã€ç´ é¤Šé¡Œã€‘æ–°æ¸¯æ–‡åœ¨è·è˜­äººé›¢é–‹å¾Œï¼Œä»ç„¶è¢«å¹³åŸ”æ—äººä½¿ç”¨äº†å¾ˆä¹…ï¼Œä¸»è¦ç”¨ä¾†åšä»€éº¼ï¼Ÿ", options: ["å¯«æƒ…æ›¸", "è¨‚å®šåœŸåœ°å¥‘ç´„(ç•ªä»”å¥‘)", "å¯«å°èªª", "ç´€éŒ„é£Ÿè­œ"], a: "è¨‚å®šåœŸåœ°å¥‘ç´„(ç•ªä»”å¥‘)" },
            { t: "tf", q: "è·è˜­äººå°‡è‡ºç£çš„é¹¿çš®ä¸»è¦å¤–éŠ·åˆ°æ—¥æœ¬ï¼Œç”¨ä¾†è£½ä½œæ­¦å£«çš„æˆ°è¢ã€‚", a: "O" },
            { t: "choice", q: "é—œæ–¼å¤§èˆªæµ·æ™‚ä»£å°è‡ºç£çš„å½±éŸ¿ï¼Œä¸‹åˆ—æ•˜è¿°ä½•è€…éŒ¯èª¤ï¼Ÿ", options: ["è‡ºç£è¢«ç´å…¥ä¸–ç•Œè²¿æ˜“é«”ç³»", "å¼•é€²äº†é»ƒç‰›å¹«åŠ©è€•ä½œ", "é€ æˆé‡ç”Ÿæ¢…èŠ±é¹¿æ•¸é‡å¤§å¢", "åŸºç£æ•™èˆ‡å¤©ä¸»æ•™å‚³å…¥è‡ºç£"], a: "é€ æˆé‡ç”Ÿæ¢…èŠ±é¹¿æ•¸é‡å¤§å¢" },

            // è£œå……æ··åˆé¡Œåº«ä»¥æ¹Šæ»¿ 50 é¡Œ (å»¶ä¼¸è€ƒå¤é¡Œ)
            { t: "tf", q: "é•·æ¿±æ–‡åŒ–çš„äººé¡ä¸»è¦å±…ä½åœ¨æµ·é‚Šçš„æ´ç©´ä¸­ã€‚", a: "O" },
            { t: "choice", q: "åœ“å±±æ–‡åŒ–çš„éºå€ä¸­æœ€è‘—åçš„ç‰¹å¾µæ˜¯ä»€éº¼ï¼Ÿ", options: ["è²å¡š", "çŸ³æ¿æ£º", "ç…‰éµçˆ", "å·¨çŸ³"], a: "è²å¡š" },
            { t: "choice", q: "å“ªä¸€å€‹åŸä½æ°‘æ—æœ‰è‘—åçš„ã€Œå…«éƒ¨åˆéŸ³ã€ï¼Ÿ", options: ["å¸ƒè¾²æ—", "é„’æ—", "é˜¿ç¾æ—", "æ³°é›…æ—"], a: "å¸ƒè¾²æ—" },
            { t: "choice", q: "é­¯å‡±æ—èˆ‡æ’ç£æ—ä¸€æ¨£ï¼Œéƒ½å–œæ„›ä½¿ç”¨ä»€éº¼åœ–é¨°ï¼Ÿ", options: ["ç™¾æ­¥è›‡", "é£›é­š", "å±±è±¬", "è€é·¹"], a: "ç™¾æ­¥è›‡" },
            { t: "choice", q: "è·è˜­äººåœ¨èµ¤å´ï¼ˆä»Šè‡ºå—å¸‚å€ï¼‰å»ºç«‹äº†å“ªä¸€åº§åŸï¼Œä½œç‚ºå•†æ¥­è¡Œæ”¿ä¸­å¿ƒï¼Ÿ", options: ["ç†±è˜­é®åŸ", "æ™®ç¾…æ°‘é®åŸ", "è–è–©çˆ¾ç“¦å¤šåŸ", "å„„è¼‰é‡‘åŸ"], a: "æ™®ç¾…æ°‘é®åŸ" },
            { t: "choice", q: "è¥¿ç­ç‰™äººå› ç‚ºä»€éº¼åŸå› ï¼Œå¾Œä¾†æ¸›å°‘é§è»ä¸¦æ’¤å‡ºè‡ºç£ï¼Ÿ", options: ["æ°´åœŸä¸æœèˆ‡è²¿æ˜“ä¸é †", "è¢«åŸä½æ°‘æ‰“æ•—", "è¢«æ—¥æœ¬æ¶ˆæ»…", "ç™¼ç¾æ¾³æ´²"], a: "æ°´åœŸä¸æœèˆ‡è²¿æ˜“ä¸é †" },
            { t: "tf", q: "åä¸‰è¡Œæ–‡åŒ–çš„äººé¡å·²ç¶“æœƒä½¿ç”¨é™¶å™¨ï¼Œé€™ç¨®é™¶å™¨é€šå¸¸æ˜¯ç´…è¤è‰²çš„ã€‚", a: "O" },
            { t: "choice", q: "ä¸‹åˆ—å“ªä¸€å€‹ä¸æ˜¯å¹³åŸ”æ—ç¾¤ï¼Ÿ", options: ["å‡±é”æ ¼è˜­æ—", "è¥¿æ‹‰é›…æ—", "å™¶ç‘ªè˜­æ—", "é›…ç¾æ—"], a: "é›…ç¾æ—" },
            { t: "choice", q: "ã€Œç‹ç”°ã€æ˜¯è·è˜­æ™‚ä»£çš„åœŸåœ°åˆ¶åº¦ï¼Œä»£è¡¨åœŸåœ°æ‰€æœ‰æ¬Šå±¬æ–¼èª°ï¼Ÿ", options: ["è¾²æ°‘", "è·è˜­æ±å°åº¦å…¬å¸(ç‹)", "åŸä½æ°‘é ­ç›®", "æ—¥æœ¬å¹•åºœ"], a: "è·è˜­æ±å°åº¦å…¬å¸(ç‹)" },
            { t: "choice", q: "å“ªä¸€å€‹å²å‰æ–‡åŒ–çš„äººé¡æœƒä½¿ç”¨ã€ŒçŸ³æ¿æ£ºã€ä¾†åŸ‹è‘¬æ­»è€…ï¼Ÿ", options: ["å‘å—æ–‡åŒ–", "é•·æ¿±æ–‡åŒ–", "å¤§åŒå‘æ–‡åŒ–", "ç¶²å½¢æ–‡åŒ–"], a: "å‘å—æ–‡åŒ–" },
            { t: "choice", q: "ç›®å‰æ”¿åºœèªå®šçš„è‡ºç£åŸä½æ°‘æ—å…±æœ‰å¹¾æ—ï¼Ÿ(ä¾æ“šæœ€æ–°èª²æœ¬èˆ‡æ”¿åºœå…¬å‘Š)", options: ["9æ—", "12æ—", "16æ—", "20æ—"], a: "16æ—" },
            { t: "choice", q: "è·è˜­äººå¼•é€²å“ªç¨®å‹•ç‰©ä¾†å”åŠ©æ¼¢äººé–‹å¢¾è’åœ°ï¼Ÿ", options: ["é»ƒç‰›", "æ°´ç‰›", "é¦¬", "ç¾Š"], a: "é»ƒç‰›" },
            { t: "choice", q: "è³½å¤æ—çš„çŸ®éˆç¥­é€šå¸¸å¹¾å¹´èˆ‰è¾¦ä¸€æ¬¡å¤§ç¥­ï¼Ÿ", options: ["æ¯å¹´", "å…©å¹´", "åå¹´", "åå¹´ä¸€å¤§ç¥­(å…©å¹´ä¸€å°ç¥­)"], a: "åå¹´ä¸€å¤§ç¥­(å…©å¹´ä¸€å°ç¥­)" },
            { t: "tf", q: "å²å‰æ™‚ä»£æ˜¯æŒ‡ã€Œé‚„æ²’æœ‰æ–‡å­—è¨˜è¼‰ã€çš„æ™‚ä»£ã€‚", a: "O" },
            { t: "choice", q: "ä¸‹åˆ—ä½•è€…æ˜¯èˆŠçŸ³å™¨æ™‚ä»£äººé¡ç²å–é£Ÿç‰©çš„ä¸»è¦æ–¹å¼ï¼Ÿ", options: ["ç¨®æ¤æ°´ç¨»", "é£¼é¤Šå®¶ç•œ", "æ¡é›†èˆ‡æ¼çµ", "è³¼è²·"], a: "æ¡é›†èˆ‡æ¼çµ" },
            { t: "choice", q: "åœ¨è˜­å¶¼çš„é”æ‚Ÿæ—äººï¼Œä»–å€‘çš„æˆ¿å±‹è¨­è¨ˆä¸»è¦æ˜¯ç‚ºäº†é˜²é¢±ï¼Œç¨±ç‚ºï¼Ÿ", options: ["é«˜è…³å±‹", "åœ°ä¸‹å±‹", "çŸ³æ¿å±‹", "å¹²æ¬„å¼å»ºç¯‰"], a: "åœ°ä¸‹å±‹" },
            { t: "choice", q: "ä¸‹åˆ—å“ªç¨®ç‰©å“ä¸æ˜¯å°ç£å¤§èˆªæµ·æ™‚ä»£ä¸»è¦çš„è½‰å£è²¿æ˜“å•†å“ï¼Ÿ", options: ["çµ²ç¶¢", "ç“·å™¨", "é¦™æ–™", "é›»è…¦"], a: "é›»è…¦" },
            { t: "choice", q: "é‚µæ—ä¸»è¦å±…ä½åœ¨å“ªå€‹é¢¨æ™¯åå‹å€é™„è¿‘ï¼Ÿ", options: ["é˜¿é‡Œå±±", "æ—¥æœˆæ½­", "å¤ªé­¯é–£", "å¢¾ä¸"], a: "æ—¥æœˆæ½­" },
            { t: "choice", q: "å™¶ç‘ªè˜­æ—åŸæœ¬ä¸»è¦å±…ä½åœ¨ç¾åœ¨çš„å“ªå€‹ç¸£å¸‚ï¼Ÿ", options: ["å°åŒ—å¸‚", "å®œè˜­ç¸£", "èŠ±è“®ç¸£", "å°æ±ç¸£"], a: "å®œè˜­ç¸£" },
            { t: "choice", q: "è·è˜­æ™‚ä»£çš„å‚³æ•™å£«ç”˜æ²»å£«ç­‰äººï¼Œä¸»è¦æ˜¯å‘å“ªä¸€æ—å‚³æ•™ï¼Ÿ", options: ["è¥¿æ‹‰é›…æ—", "æ³°é›…æ—", "é˜¿ç¾æ—", "å¸ƒè¾²æ—"], a: "è¥¿æ‹‰é›…æ—" },
            { t: "tf", q: "è¥¿ç­ç‰™äººæ›¾ç¶“åœ¨åŸºéš†å’Œå¹³å³¶å»ºç«‹è–è–©çˆ¾ç“¦å¤šåŸã€‚", a: "O" },
            { t: "choice", q: "åŸä½æ°‘æ—ä¸­çš„ã€Œç´‹é¢ã€æ–‡åŒ–ï¼Œä¸»è¦æ˜¯å“ªå…©å€‹æ—ç¾¤çš„ç‰¹å¾µï¼Ÿ", options: ["æ³°é›…æ—ã€è³½å¾·å…‹æ—", "é˜¿ç¾æ—ã€å‘å—æ—", "å¸ƒè¾²æ—ã€é„’æ—", "é­¯å‡±æ—ã€æ’ç£æ—"], a: "æ³°é›…æ—ã€è³½å¾·å…‹æ—" },
            { t: "choice", q: "æ–°çŸ³å™¨æ™‚ä»£èˆ‡èˆŠçŸ³å™¨æ™‚ä»£æœ€å¤§çš„å·®åˆ¥åœ¨æ–¼å‡ºç¾äº†ä»€éº¼ï¼Ÿ", options: ["ç”¨ç«", "è¾²æ¥­èˆ‡é™¶å™¨", "é‡‘å±¬å™¨", "æ–‡å­—"], a: "è¾²æ¥­èˆ‡é™¶å™¨" },
            { t: "choice", q: "ã€æ´»ç”¨é¡Œã€‘å¦‚æœæ™‚å…‰å›åˆ°1640å¹´çš„å°ç£ï¼Œä½ å¯èƒ½æœƒåœ¨å°å—çœ‹åˆ°å“ªåœ‹äººçš„å£«å…µï¼Ÿ", options: ["è‹±åœ‹äºº", "è·è˜­äºº", "æ³•åœ‹äºº", "ç¾åœ‹äºº"], a: "è·è˜­äºº" },
            { t: "choice", q: "å“ªä¸€ç¨®è¾²ä½œç‰©æ˜¯è·è˜­äººç‚ºäº†ç¶“æ¿Ÿåˆ©ç›Šè€Œå¤§é‡æ¨å»£ç¨®æ¤çš„ï¼Ÿ", options: ["ç”˜è”—", "å°éº¥", "ç‰ç±³", "é«˜ç²±"], a: "ç”˜è”—" }
        ];

        // --- å…¨åŸŸè®Šæ•¸ ---
        let currentQuestions = [];
        let timerInterval;
        let timeLeft = 40 * 60; // 40åˆ†é˜
        let isReviewMode = false;

        // --- åˆå§‹åŒ–èˆ‡é–‹å§‹ ---
        function randomizeAndStart() {
            // æ´—ç‰Œä¸¦å–50é¡Œ (é¡Œåº«è‹¥ä¸è¶³50å‰‡å…¨å–ï¼Œè‹¥è¶…éå‰‡éš¨æ©Ÿ50)
            const shuffled = [...fullQuestionBank].sort(() => 0.5 - Math.random());
            currentQuestions = shuffled.slice(0, 50);

            // é¡¯ç¤ºä»‹é¢
            document.getElementById('startScreen').classList.add('hidden');
            document.getElementById('quizContainer').classList.remove('hidden');
            document.getElementById('statsFooter').classList.remove('hidden');
            document.getElementById('timerDisplay').classList.remove('hidden');

            renderQuestions();
            startTimer();
            updateStats();
        }

        // --- æ¸²æŸ“é¡Œç›® ---
        function renderQuestions() {
            const list = document.getElementById('questionsList');
            list.innerHTML = '';

            currentQuestions.forEach((q, index) => {
                const qNum = index + 1;
                let html = `
                <div class="question-card bg-white p-6 rounded-lg shadow border-l-4 border-blue-500" id="q_card_${index}">
                    <div class="flex justify-between items-start mb-4">
                        <h3 class="text-lg font-bold text-gray-800">
                            <span class="bg-blue-100 text-blue-800 px-2 py-1 rounded text-sm mr-2">ç¬¬ ${qNum} é¡Œ</span>
                            ${q.q}
                        </h3>
                        <label class="flex items-center space-x-2 text-sm text-yellow-600 cursor-pointer select-none">
                            <input type="checkbox" onchange="updateStats()" class="review-check form-checkbox h-5 w-5 text-yellow-500 rounded focus:ring-yellow-500">
                            <span>ç¨å¾Œä½œç­”</span>
                        </label>
                    </div>
                `;

                if (q.t === 'choice' || q.t === 'choice-multi') {
                    html += `<div class="grid grid-cols-1 md:grid-cols-2 gap-3">`;
                    q.options.forEach(opt => {
                        html += `
                        <label class="option-label border rounded-md p-3 flex items-center gap-3">
                            <input type="radio" name="q_${index}" value="${opt}" class="form-radio h-5 w-5 text-blue-600" onchange="updateStats()">
                            <span class="text-gray-700">${opt}</span>
                        </label>`;
                    });
                    html += `</div>`;
                } else if (q.t === 'tf') {
                    html += `<div class="flex gap-6">`;
                    ['O', 'X'].forEach(opt => {
                        html += `
                        <label class="option-label border rounded-md px-6 py-3 flex items-center gap-3 flex-1 justify-center">
                            <input type="radio" name="q_${index}" value="${opt}" class="form-radio h-5 w-5 text-blue-600" onchange="updateStats()">
                            <span class="text-xl font-bold ${opt==='O'?'text-green-600':'text-red-600'}">${opt}</span>
                        </label>`;
                    });
                    html += `</div>`;
                }

                // çµæœé¡¯ç¤ºå€ (éš±è—)
                html += `<div id="feedback_${index}" class="hidden mt-4 p-3 rounded bg-gray-50 text-sm"></div>`;
                html += `</div>`;
                list.innerHTML += html;
            });
        }

        // --- çµ±è¨ˆæ›´æ–° ---
        function updateStats() {
            if (isReviewMode) return;
            
            const total = currentQuestions.length;
            let answered = 0;
            let marked = 0;

            // è¨ˆç®—å·²ç­”
            for (let i = 0; i < total; i++) {
                const inputs = document.getElementsByName(`q_${i}`);
                for (let input of inputs) {
                    if (input.checked) {
                        answered++;
                        break;
                    }
                }
            }
            
            // è¨ˆç®—æ¨™è¨˜
            const checks = document.querySelectorAll('.review-check');
            checks.forEach(c => { if(c.checked) marked++; });

            document.getElementById('answeredCount').innerText = answered;
            document.getElementById('unansweredCount').innerText = total - answered;
            document.getElementById('markedCount').innerText = marked;
        }

        // --- è¨ˆæ™‚å™¨ ---
        function startTimer() {
            const display = document.getElementById('timerDisplay');
            
            timerInterval = setInterval(() => {
                timeLeft--;
                const m = Math.floor(timeLeft / 60).toString().padStart(2, '0');
                const s = (timeLeft % 60).toString().padStart(2, '0');
                display.innerText = `${m}:${s}`;

                // æé†’é‚è¼¯
                if (timeLeft === 15 * 60) Swal.fire('â³ æé†’', 'è€ƒè©¦å‰©ä¸‹ 15 åˆ†é˜ï¼', 'info');
                if (timeLeft === 8 * 60) Swal.fire('â³ æé†’', 'è€ƒè©¦å‰©ä¸‹ 8 åˆ†é˜ï¼Œè«‹æŠŠæ¡æ™‚é–“ï¼', 'warning');
                if (timeLeft === 5 * 60) Swal.fire('ğŸš¨ ç·Šæ€¥', 'å‰©ä¸‹ 5 åˆ†é˜ï¼è«‹æª¢æŸ¥æ˜¯å¦é‚„æœ‰æœªå¡«å¯«çš„é¡Œç›®ã€‚', 'warning');

                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    Swal.fire('â° æ™‚é–“åˆ°', 'è€ƒè©¦çµæŸï¼Œç³»çµ±å°‡è‡ªå‹•ç¹³å·ã€‚', 'error').then(() => {
                        submitQuiz(true); // å¼·åˆ¶ç¹³å·
                    });
                }
            }, 1000);
        }

        // --- ç¹³å·å˜—è©¦ ---
        function attemptSubmit() {
            const unans = parseInt(document.getElementById('unansweredCount').innerText);
            const marked = parseInt(document.getElementById('markedCount').innerText);

            if (unans > 0 || marked > 0) {
                Swal.fire({
                    title: 'é‚„æœ‰é¡Œç›®æœªå®Œæˆï¼',
                    text: `æœªç­”ï¼š${unans} é¡Œï¼Œç¨å¾Œä½œç­”ï¼š${marked} é¡Œã€‚ç¢ºå®šè¦äº¤å·å—ï¼Ÿ`,
                    icon: 'warning',
                    showCancelButton: true,
                    confirmButtonText: 'ç¢ºå®šäº¤å·',
                    cancelButtonText: 'ç¹¼çºŒä½œç­”'
                }).then((result) => {
                    if (result.isConfirmed) submitQuiz(false);
                });
            } else {
                Swal.fire({
                    title: 'ç¢ºå®šäº¤å·ï¼Ÿ',
                    text: 'äº¤å·å¾Œå°‡ç„¡æ³•ä¿®æ”¹ç­”æ¡ˆã€‚',
                    icon: 'question',
                    showCancelButton: true,
                    confirmButtonText: 'äº¤å·'
                }).then((result) => {
                    if (result.isConfirmed) submitQuiz(false);
                });
            }
        }

        // --- å¯¦éš›ç¹³å·èˆ‡è©•åˆ† ---
        function submitQuiz(force) {
            clearInterval(timerInterval);
            isReviewMode = true;
            
            let score = 0;
            const tableBody = document.getElementById('exportBody');
            tableBody.innerHTML = ''; // æ¸…ç©ºèˆŠè³‡æ–™
            
            currentQuestions.forEach((q, index) => {
                // 1. å–å¾—ä½¿ç”¨è€…ç­”æ¡ˆ
                const inputs = document.getElementsByName(`q_${index}`);
                let userVal = "æœªä½œç­”";
                inputs.forEach(inp => { if(inp.checked) userVal = inp.value; });
                
                // 2. åˆ¤æ–·å°éŒ¯
                const isCorrect = (userVal === q.a);
                if (isCorrect) score += 2; // 100åˆ†/50é¡Œ = 2åˆ†

                // 3. UI é–å®šèˆ‡æ¨™ç¤º
                inputs.forEach(inp => inp.disabled = true);
                const card = document.getElementById(`q_card_${index}`);
                const feedback = document.getElementById(`feedback_${index}`);
                feedback.classList.remove('hidden');
                
                if (isCorrect) {
                    card.classList.add('bg-green-50');
                    feedback.innerHTML = `<span class="text-green-700 font-bold">âœ… ç­”å°äº†ï¼</span>`;
                } else {
                    card.classList.add('bg-red-50');
                    feedback.innerHTML = `<span class="text-red-600 font-bold">âŒ ç­”éŒ¯äº†ï¼æ­£ç¢ºç­”æ¡ˆæ˜¯ï¼š${q.a}</span>`;
                    
                    // æ¨™ç¤ºæ­£ç¢ºé¸é …
                    inputs.forEach(inp => {
                       if (inp.value === q.a) {
                           inp.parentElement.classList.add('correct-answer');
                       } else if (inp.checked) {
                           inp.parentElement.classList.add('wrong-answer');
                       }
                    });
                }

                // 4. æº–å‚™ Excel è³‡æ–™ (è‹¥ç­”éŒ¯ï¼Œå­—é«”è®Šç´…)
                // ç‚ºäº†è®“ Excel é¡¯ç¤ºç´…è‰²ï¼Œæˆ‘å€‘åœ¨HTML Tableä½¿ç”¨ style
                const rowColor = isCorrect ? 'black' : 'red';
                const rowHtml = `
                    <tr style="color: ${rowColor};">
                        <td>${index + 1}</td>
                        <td>${q.q}</td>
                        <td>${userVal}</td>
                        <td>${q.a}</td>
                        <td>${isCorrect ? 'æ­£ç¢º' : 'éŒ¯èª¤'}</td>
                    </tr>
                `;
                tableBody.innerHTML += rowHtml;
            });

            // 5. æ›´æ–°ä»‹é¢é¡¯ç¤ºåˆ†æ•¸
            const statsFooter = document.getElementById('statsFooter');
            statsFooter.innerHTML = `
                <div class="flex-1 flex justify-center items-center gap-4">
                    <span class="text-2xl font-bold text-gray-800">ç¸½åˆ†ï¼š<span class="text-blue-600 text-4xl">${score}</span> åˆ†</span>
                    <button onclick="downloadResults()" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded shadow">
                        ğŸ“¥ ä¸‹è¼‰æˆç¸¾èˆ‡éŒ¯é¡Œ (Excel)
                    </button>
                    <button onclick="checkAnswersWithPassword()" class="bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded shadow">
                        ğŸ”’ é¡¯ç¤ºè©³è§£æ¨¡å¼ (å®¶é•·)
                    </button>
                </div>
            `;
            
            // æ»¾å‹•åˆ°é ‚éƒ¨é¡¯ç¤ºåˆ†æ•¸
            window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' });
            Swal.fire({
                title: 'è€ƒè©¦çµæŸï¼',
                html: `ä½ çš„å¾—åˆ†æ˜¯ <b>${score}</b> åˆ†ã€‚<br>è«‹ä¸‹è¼‰ Excel æª”æ¡ˆä»¥ä¿å­˜éŒ¯é¡Œè¨˜éŒ„ã€‚`,
                icon: score >= 80 ? 'success' : 'warning'
            });

            // éš±è—äº¤å·æŒ‰éˆ•
            document.querySelector('button[onclick="attemptSubmit()"]').style.display = 'none';
        }

        // --- å¯†ç¢¼ä¿è­·åŠŸèƒ½ ---
        async function checkAnswersWithPassword() {
            const { value: password } = await Swal.fire({
                title: 'è«‹è¼¸å…¥å¯†ç¢¼',
                input: 'password',
                inputLabel: 'å¯†ç¢¼ç‚º 1234',
                inputPlaceholder: 'è«‹è¼¸å…¥å¯†ç¢¼',
                confirmButtonText: 'ç¢ºèª',
                showCancelButton: true
            });

            if (password === '1234') {
                Swal.fire('é©—è­‰æˆåŠŸ', 'ç¾åœ¨æ‚¨å¯ä»¥æŸ¥çœ‹æ‰€æœ‰é¡Œç›®çš„æ­£ç¢ºç­”æ¡ˆèˆ‡è§£æã€‚', 'success');
                // é€™è£¡å…¶å¯¦ç•«é¢å·²ç¶“é¡¯ç¤ºäº†ï¼Œæ­¤åŠŸèƒ½ä½œç‚ºæƒ…å¢ƒæ¨¡æ“¬
            } else if (password) {
                Swal.fire('å¯†ç¢¼éŒ¯èª¤', 'è«‹é‡æ–°è¼¸å…¥ã€‚', 'error');
            }
        }

        // --- åŒ¯å‡º Excel (å«ç´…å­—) ---
        function downloadResults() {
            // ä½¿ç”¨ SheetJS å°‡ HTML Table è½‰ç‚º Workbook
            const tbl = document.getElementById('exportTable');
            const wb = XLSX.utils.table_to_book(tbl, {sheet:"æœŸæœ«è€ƒæˆç¸¾"});
            
            // ä¸‹è¼‰
            XLSX.writeFile(wb, 'exam_result.xlsx');
        }

    </script>
</body>
</html>
